<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>在 wsl 下安装 fedora 35 | AimerNeige&#39;s Blog</title>
<meta name="keywords" content="wsl, wsl2, fedora35, windows">
<meta name="description" content="安装 wsl2 使用管理员身份开启 windows terminal.
执行如下指令：
wsl.exe --install 等待安装完成后在开始菜单执行重启(Restart)
.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.dark .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:18px;line-height:24px;margin-bottom:24px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:currentColor}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative} Warning
注意是在开始菜单选择 Restart 而不能是选择 Shut Down 关机之后手动开机。
 安装过程中系统会自动下载 Ubuntu 的子系统，重启后会弹出 ubuntu 的命令行初始界面，输入用户名和密码即可开始使用 ubuntu 子系统。
执行下面的指令设置 wsl 默认版本为 wsl2：
wsl --set-default-version 2 安装其他版本的子系统 如果你想要其他版本的子系统，可以执行如下指令获取可通过 wsl 指令直接安装的发行版列表：
wsl --list --online 返回数据类似下面这样：
The following is a list of valid distributions that can be installed. Install using &#39;wsl --install -d &lt;Distro&gt;&#39;.">
<meta name="author" content="Aimer Neige">
<link rel="canonical" href="https://aimerneige.com/zh/post/others/install-fedora35-on-wsl/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css" integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://aimerneige.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://aimerneige.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://aimerneige.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://aimerneige.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://aimerneige.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://aimerneige.com/zh/post/others/install-fedora35-on-wsl/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5QJPQTJ618"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-5QJPQTJ618', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="在 wsl 下安装 fedora 35" />
<meta property="og:description" content="安装 wsl2 使用管理员身份开启 windows terminal.
执行如下指令：
wsl.exe --install 等待安装完成后在开始菜单执行重启(Restart)
.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.dark .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:18px;line-height:24px;margin-bottom:24px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:currentColor}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative} Warning
注意是在开始菜单选择 Restart 而不能是选择 Shut Down 关机之后手动开机。
 安装过程中系统会自动下载 Ubuntu 的子系统，重启后会弹出 ubuntu 的命令行初始界面，输入用户名和密码即可开始使用 ubuntu 子系统。
执行下面的指令设置 wsl 默认版本为 wsl2：
wsl --set-default-version 2 安装其他版本的子系统 如果你想要其他版本的子系统，可以执行如下指令获取可通过 wsl 指令直接安装的发行版列表：
wsl --list --online 返回数据类似下面这样：
The following is a list of valid distributions that can be installed. Install using &#39;wsl --install -d &lt;Distro&gt;&#39;." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://aimerneige.com/zh/post/others/install-fedora35-on-wsl/" />
<meta property="og:image" content="https://aimerneige.com/images/fedora-wsl.png" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2022-04-09T22:22:44+08:00" />
<meta property="article:modified_time" content="2022-04-09T22:22:44+08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://aimerneige.com/images/fedora-wsl.png" />
<meta name="twitter:title" content="在 wsl 下安装 fedora 35"/>
<meta name="twitter:description" content="安装 wsl2 使用管理员身份开启 windows terminal.
执行如下指令：
wsl.exe --install 等待安装完成后在开始菜单执行重启(Restart)
.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.dark .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:18px;line-height:24px;margin-bottom:24px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:currentColor}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative} Warning
注意是在开始菜单选择 Restart 而不能是选择 Shut Down 关机之后手动开机。
 安装过程中系统会自动下载 Ubuntu 的子系统，重启后会弹出 ubuntu 的命令行初始界面，输入用户名和密码即可开始使用 ubuntu 子系统。
执行下面的指令设置 wsl 默认版本为 wsl2：
wsl --set-default-version 2 安装其他版本的子系统 如果你想要其他版本的子系统，可以执行如下指令获取可通过 wsl 指令直接安装的发行版列表：
wsl --list --online 返回数据类似下面这样：
The following is a list of valid distributions that can be installed. Install using &#39;wsl --install -d &lt;Distro&gt;&#39;."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "文章 📝",
      "item": "https://aimerneige.com/zh/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "在 wsl 下安装 fedora 35",
      "item": "https://aimerneige.com/zh/post/others/install-fedora35-on-wsl/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "在 wsl 下安装 fedora 35",
  "name": "在 wsl 下安装 fedora 35",
  "description": "安装 wsl2 使用管理员身份开启 windows terminal.\n执行如下指令：\nwsl.exe --install 等待安装完成后在开始菜单执行重启(Restart)\n.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.dark .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:18px;line-height:24px;margin-bottom:24px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:currentColor}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative} Warning\n注意是在开始菜单选择 Restart 而不能是选择 Shut Down 关机之后手动开机。\n 安装过程中系统会自动下载 Ubuntu 的子系统，重启后会弹出 ubuntu 的命令行初始界面，输入用户名和密码即可开始使用 ubuntu 子系统。\n执行下面的指令设置 wsl 默认版本为 wsl2：\nwsl --set-default-version 2 安装其他版本的子系统 如果你想要其他版本的子系统，可以执行如下指令获取可通过 wsl 指令直接安装的发行版列表：\nwsl --list --online 返回数据类似下面这样：\nThe following is a list of valid distributions that can be installed. Install using \u0026#39;wsl --install -d \u0026lt;Distro\u0026gt;\u0026#39;.",
  "keywords": [
    "wsl", "wsl2", "fedora35", "windows"
  ],
  "articleBody": "安装 wsl2 使用管理员身份开启 windows terminal.\n执行如下指令：\nwsl.exe --install 等待安装完成后在开始菜单执行重启(Restart)\n.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.dark .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:18px;line-height:24px;margin-bottom:24px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:currentColor}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative} Warning\n注意是在开始菜单选择 Restart 而不能是选择 Shut Down 关机之后手动开机。\n 安装过程中系统会自动下载 Ubuntu 的子系统，重启后会弹出 ubuntu 的命令行初始界面，输入用户名和密码即可开始使用 ubuntu 子系统。\n执行下面的指令设置 wsl 默认版本为 wsl2：\nwsl --set-default-version 2 安装其他版本的子系统 如果你想要其他版本的子系统，可以执行如下指令获取可通过 wsl 指令直接安装的发行版列表：\nwsl --list --online 返回数据类似下面这样：\nThe following is a list of valid distributions that can be installed. Install using 'wsl --install -d '. NAME FRIENDLY NAME Ubuntu Ubuntu Debian Debian GNU/Linux kali-linux Kali Linux Rolling openSUSE-42 openSUSE Leap 42 SLES-12 SUSE Linux Enterprise Server v12 Ubuntu-16.04 Ubuntu 16.04 LTS Ubuntu-18.04 Ubuntu 18.04 LTS Ubuntu-20.04 Ubuntu 20.04 LTS 如果想要安装某发行版，直接执行相应指令即可。例如可以通过下面的指令安装 debian 子系统：\nwsl --install -d Debian 当你安装了多个发行版，可以通过下面的指令指定默认发行版：\nwsl --setdefault  例如，设置 Kali-linux 为默认发行版：\nwsl --setdefault Kali-linux 安装 fedora 35 wsl 提供的发行版中，并不包含 fedora 系统，所以只能手动安装。\n下载 fedora 镜像文件(rootfs image) 在 Fedora-Container-Base 选择需要的 fedora 版本下载。\n在保证 State 一栏为 complete 的前提下找到需要的版本。\nFedora 35 build\n我们要下载的文件是 xz 格式，同时选择正确的架构，如 x86_64。\n(点击下面的链接直接下载)\nFedora-Container-Base-35-20220221.0.x86_64.tar.xz\n下载好之后解压这个压缩文件，如果你不知道用什么软件，下载使用 7-Zip。\nWarning\n注意，解压为 tar 文件即可，不要继续解压 tar 文件。\n 此时，查看你刚刚得到的 tar 文件，在里面找到一个名为 layer.tar 的文件，单独解压它，他就是我们需要的 rootfs image。把它解压到一个容易找到的位置，比如 Downloads 目录。为了便于使用，你可以将它重命名为 fedora-35-rootfs.tar。\n如果你想要一些更加官方的系统镜像，可以在 docker-brew-fedora 项目中找到你想要的文件。\n直接在 仓库 中找到对应的版本和架构后下载对应的文件即可。比如，你可能下载了 fedora-35-x86_64.tar.xz，下载完成后，解压这个文件，得到 tar 文件，这个 tar 文件就是 rootfs image。如果愿意，你也可以将它重命名为 fedora-35-rootfs.tar。\n创建你的 wsl 存储目录 创建一个文件夹来保存你的 wsl 文件。\nmkdir $HOME\\wsl\\fedora 释放镜像文件 假设你想要将子系统命名为 fedora，想要把它保存在 $HOME\\wsl\\fedora 目录下，同时 rootfs 文件存储在 $HOME\\Downloads\\fedora-35-rootfs.tar，执行下面的指令：\nwsl --import fedora $HOME\\wsl\\fedora $HOME\\Downloads\\fedora-35-rootfs.tar 检查安装情况 wsl -l 使用 root 启动 fedora 子系统： wsl -d fedora 设置 fedora 为默认发行版 wsl -s fedora 修复问题 Info\n注：以下问题是否存在取决于你下载的 fedora 版本，如果你没有对应错误直接跳过即可。\n 挂载错误 如果你在第一次启动 fedora 时得到了以下错误：\nAn error occurred mounting one of your file systems. Please run 'dmesg' for more details. 这是由于系统缺少 mount 指令造成的，如果你不需要 mount 指令也不在意错误，完全可以忽略这个错误（虽然还是建议修一下）。\n安装 util-linux 这个包即可。（如果你是一个极简主义者，安装 util-linux-core 这个包）\ndnf install -y util-linux 安装完成后关闭 fedora 重启即可。\nwsl -t fedora 配置你的 fedora 升级系统 dnf update 创建用户 继续之前，先安装下面的包：\ndnf install -y passwd cracklib-dicts 在 wheel 用户组下创建名为 myusername 的用户\nuseradd -G wheel myusername 为用户 myusername 设置密码\npasswd myusername 使用指定用户登录 wsl\nwsl -d fedora -u myusername 查看是否成功\nwhoami 检查是否具有 sudo 权限\nsudo cat /etc/shadow 设置默认用户 首先你的系统必须是 Windows build 18980 之后的版本，只需要 修改 wsl 配置文件 即可。\n如果你没有创建过 /etc/wsl.conf 文件，直接执行如下指令：\nprintf \"\\n[user]\\ndefault = myusername\\n\" | sudo tee -a /etc/wsl.conf 或者手动添加下面内容到 /etc/wsl.conf：\n[user] default = myusername 关闭 fedora 子系统。\nwsl -t fedora 在不指定用户的情况下启动 fedora 子系统，检查用户是否正确。\n容器 如果你需要运行容器，重新安装 shadow-utils 确保修复一些 rootfs 带来的错误：\nsudo dnf reinstall -y shadow-utils ping 如果你想要执行 ping 指令，执行下面的操作：\nsudo dnf install -y procps-ng iputils sudo sysctl -w net.ipv4.ping_group_range=\"0 2000\" 常用指令 安装下面的包来启用 Linux 下常用指令：\nsudo dnf -y install iproute findutils ncurses initscripts 编辑器 安装必要的编辑器，你可以按照喜好选择 vim nano 或 micro。\nsudo dnf install -y vim man 继续之前首先要确保 nodocs 选项没有被开启，你可以手动编辑 tsflags=nodocs 这一行，也可以直接执行下面的指令：\ngrep -v nodocs /etc/dnf/dnf.conf | sudo tee /etc/dnf/dnf.conf 接下来安装 man\nsudo dnf install -y man man-pages 安装完成之后，在这之后安装的软件就可以使用 man 指令查看文档了，但是之前已经安装好的软件，并不能查看文档，比如现在执行 man dnf 就不会得到任何结果。需要执行 sudo dnf reinstall -y dnf 重新安装 dnf 之后，才可以正确查看相关文档。\n执行下面的指令重新安装全部的包：\nWarning\n这一步非常费时，如果你不常用 man 可以选择跳过。\n for pkg in $(dnf repoquery --installed --qf \"%{name}\"); do sudo dnf reinstall -qy $pkg; done 允许调用 Windows 的浏览器 首先安装 wslu\nsudo dnf copr enable wslutilities/wslu sudo dnf install wslu 添加如下配置\nexport BROWSER=wslview 导出系统 为了方便之后安装，可以将系统导出。\n首先清理掉缓存文件：\nsudo dnf clean all 使用下面的指令导出 fedora 子系统到 $HOME\\Downloads\\fedora-wsl.tar 目录下。\nwsl --export fedora $HOME\\Downloads\\fedora-wsl.tar 之后要使用的时候，可以使用下面的指令导入：\nmkdir $HOME\\wsl\\freshfedora wsl --import freshfedora $HOME\\wsl\\freshfedora $HOME\\Downloads\\fedora-wsl.tar wsl 常用指令 查看当前正在运行的子系统 wsl --list --running 关闭指定子系统 wsl --terminate  例如关闭正在运行的 Ubuntu 子系统：\nwsl --terminate Ubuntu 关闭全部子系统 wsl --shutdown 升级 wsl wsl --update 版本回滚 wsl --update --rollback 删除子系统 wsl --unregister  wsl 使用技巧 在文件资源管理器中输入 \\\\wsl$ 即可进入 wsl 的目录。可以将它添加到文件资源管理器的网络路径里便于访问。\n参考  Install Fedora 36 or earlier on Windows Subsystem for Linux (WSL)\n ",
  "wordCount" : "543",
  "inLanguage": "zh",
  "image":"https://aimerneige.com/images/fedora-wsl.png","datePublished": "2022-04-09T22:22:44+08:00",
  "dateModified": "2022-04-09T22:22:44+08:00",
  "author":{
    "@type": "Person",
    "name": "Aimer Neige"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://aimerneige.com/zh/post/others/install-fedora35-on-wsl/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "AimerNeige's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://aimerneige.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://aimerneige.com/zh/" accesskey="h" title="AimerNeige&#39;s Blog (Alt + H)">AimerNeige&#39;s Blog</a>
            <div class="logo-switches">
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://aimerneige.com/en/" title="English"
                            aria-label="English">English</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://aimerneige.com/zh/about/" title="关于">
                    <span>关于</span>
                </a>
            </li>
            <li>
                <a href="https://aimerneige.com/zh/post/" title="文章">
                    <span>文章</span>
                </a>
            </li>
            <li>
                <a href="https://aimerneige.com/zh/archives/" title="归档">
                    <span>归档</span>
                </a>
            </li>
            <li>
                <a href="https://aimerneige.com/zh/tags/" title="标签">
                    <span>标签</span>
                </a>
            </li>
            <li>
                <a href="https://aimerneige.com/zh/categories/" title="分类">
                    <span>分类</span>
                </a>
            </li>
            <li>
                <a href="https://aimerneige.com/zh/search/" title="搜索">
                    <span>搜索</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://aimerneige.com/zh/">主页</a>&nbsp;»&nbsp;<a href="https://aimerneige.com/zh/post/">文章 📝</a></div>
    <h1 class="post-title">
      在 wsl 下安装 fedora 35
    </h1>
    <div class="post-meta"><span title='2022-04-09 22:22:44 +0800 CST'>四月 9, 2022</span>&nbsp;·&nbsp;Aimer Neige&nbsp;|&nbsp;<a href="https://github.com/aimerneige/blog/edit/master/content/post/Others/install-fedora35-on-wsl.zh.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://aimerneige.com/images/fedora-wsl.png" alt="Fedora Windows">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">目录</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85-wsl2" aria-label="安装 wsl2">安装 wsl2</a></li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85%e5%85%b6%e4%bb%96%e7%89%88%e6%9c%ac%e7%9a%84%e5%ad%90%e7%b3%bb%e7%bb%9f" aria-label="安装其他版本的子系统">安装其他版本的子系统</a></li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85-fedora-35" aria-label="安装 fedora 35">安装 fedora 35</a><ul>
                        
                <li>
                    <a href="#%e4%b8%8b%e8%bd%bd-fedora-%e9%95%9c%e5%83%8f%e6%96%87%e4%bb%b6rootfs-image" aria-label="下载 fedora 镜像文件(rootfs image)">下载 fedora 镜像文件(<strong>rootfs</strong> image)</a></li>
                <li>
                    <a href="#%e5%88%9b%e5%bb%ba%e4%bd%a0%e7%9a%84-wsl-%e5%ad%98%e5%82%a8%e7%9b%ae%e5%bd%95" aria-label="创建你的 wsl 存储目录">创建你的 wsl 存储目录</a></li>
                <li>
                    <a href="#%e9%87%8a%e6%94%be%e9%95%9c%e5%83%8f%e6%96%87%e4%bb%b6" aria-label="释放镜像文件">释放镜像文件</a></li>
                <li>
                    <a href="#%e6%a3%80%e6%9f%a5%e5%ae%89%e8%a3%85%e6%83%85%e5%86%b5" aria-label="检查安装情况">检查安装情况</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8-root-%e5%90%af%e5%8a%a8-fedora-%e5%ad%90%e7%b3%bb%e7%bb%9f" aria-label="使用 root 启动 fedora 子系统：">使用 root 启动 fedora 子系统：</a></li>
                <li>
                    <a href="#%e8%ae%be%e7%bd%ae-fedora-%e4%b8%ba%e9%bb%98%e8%ae%a4%e5%8f%91%e8%a1%8c%e7%89%88" aria-label="设置 fedora 为默认发行版">设置 fedora 为默认发行版</a></li></ul>
                </li>
                <li>
                    <a href="#%e4%bf%ae%e5%a4%8d%e9%97%ae%e9%a2%98" aria-label="修复问题">修复问题</a><ul>
                        
                <li>
                    <a href="#%e6%8c%82%e8%bd%bd%e9%94%99%e8%af%af" aria-label="挂载错误">挂载错误</a></li></ul>
                </li>
                <li>
                    <a href="#%e9%85%8d%e7%bd%ae%e4%bd%a0%e7%9a%84-fedora" aria-label="配置你的 fedora">配置你的 fedora</a><ul>
                        
                <li>
                    <a href="#%e5%8d%87%e7%ba%a7%e7%b3%bb%e7%bb%9f" aria-label="升级系统">升级系统</a></li>
                <li>
                    <a href="#%e5%88%9b%e5%bb%ba%e7%94%a8%e6%88%b7" aria-label="创建用户">创建用户</a></li>
                <li>
                    <a href="#%e8%ae%be%e7%bd%ae%e9%bb%98%e8%ae%a4%e7%94%a8%e6%88%b7" aria-label="设置默认用户">设置默认用户</a></li>
                <li>
                    <a href="#%e5%ae%b9%e5%99%a8" aria-label="容器">容器</a></li>
                <li>
                    <a href="#ping" aria-label="ping">ping</a></li>
                <li>
                    <a href="#%e5%b8%b8%e7%94%a8%e6%8c%87%e4%bb%a4" aria-label="常用指令">常用指令</a></li>
                <li>
                    <a href="#%e7%bc%96%e8%be%91%e5%99%a8" aria-label="编辑器">编辑器</a></li>
                <li>
                    <a href="#man" aria-label="man">man</a></li>
                <li>
                    <a href="#%e5%85%81%e8%ae%b8%e8%b0%83%e7%94%a8-windows-%e7%9a%84%e6%b5%8f%e8%a7%88%e5%99%a8" aria-label="允许调用 Windows 的浏览器">允许调用 Windows 的浏览器</a></li>
                <li>
                    <a href="#%e5%af%bc%e5%87%ba%e7%b3%bb%e7%bb%9f" aria-label="导出系统">导出系统</a></li></ul>
                </li>
                <li>
                    <a href="#wsl-%e5%b8%b8%e7%94%a8%e6%8c%87%e4%bb%a4" aria-label="wsl 常用指令">wsl 常用指令</a><ul>
                        
                <li>
                    <a href="#%e6%9f%a5%e7%9c%8b%e5%bd%93%e5%89%8d%e6%ad%a3%e5%9c%a8%e8%bf%90%e8%a1%8c%e7%9a%84%e5%ad%90%e7%b3%bb%e7%bb%9f" aria-label="查看当前正在运行的子系统">查看当前正在运行的子系统</a></li>
                <li>
                    <a href="#%e5%85%b3%e9%97%ad%e6%8c%87%e5%ae%9a%e5%ad%90%e7%b3%bb%e7%bb%9f" aria-label="关闭指定子系统">关闭指定子系统</a></li>
                <li>
                    <a href="#%e5%85%b3%e9%97%ad%e5%85%a8%e9%83%a8%e5%ad%90%e7%b3%bb%e7%bb%9f" aria-label="关闭全部子系统">关闭全部子系统</a></li>
                <li>
                    <a href="#%e5%8d%87%e7%ba%a7-wsl" aria-label="升级 wsl">升级 wsl</a></li>
                <li>
                    <a href="#%e7%89%88%e6%9c%ac%e5%9b%9e%e6%bb%9a" aria-label="版本回滚">版本回滚</a></li>
                <li>
                    <a href="#%e5%88%a0%e9%99%a4%e5%ad%90%e7%b3%bb%e7%bb%9f" aria-label="删除子系统">删除子系统</a></li></ul>
                </li>
                <li>
                    <a href="#wsl-%e4%bd%bf%e7%94%a8%e6%8a%80%e5%b7%a7" aria-label="wsl 使用技巧">wsl 使用技巧</a></li>
                <li>
                    <a href="#%e5%8f%82%e8%80%83" aria-label="参考">参考</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="安装-wsl2">安装 wsl2<a hidden class="anchor" aria-hidden="true" href="#安装-wsl2">#</a></h2>
<p>使用管理员身份开启 windows terminal.</p>
<p>执行如下指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl.exe --install
</code></pre></div><p>等待安装完成后在开始菜单执行重启(Restart)</p>
<style type="text/css">.notice{--root-color:#444;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#c33;--warning-content:#fee;--info-title:#fb7;--info-content:#fec;--note-title:#6be;--note-content:#e7f2fa;--tip-title:#5a5;--tip-content:#efe}@media (prefers-color-scheme:dark){.notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}}body.dark .notice{--root-color:#ddd;--root-background:#eff;--title-color:#fff;--title-background:#7bd;--warning-title:#800;--warning-content:#400;--info-title:#a50;--info-content:#420;--note-title:#069;--note-content:#023;--tip-title:#363;--tip-content:#121}.notice{padding:18px;line-height:24px;margin-bottom:24px;border-radius:4px;color:var(--root-color);background:var(--root-background)}.notice p:last-child{margin-bottom:0}.notice-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:var(--title-color);background:var(--title-background)}.notice.warning .notice-title{background:var(--warning-title)}.notice.warning{background:var(--warning-content)}.notice.info .notice-title{background:var(--info-title)}.notice.info{background:var(--info-content)}.notice.note .notice-title{background:var(--note-title)}.notice.note{background:var(--note-content)}.notice.tip .notice-title{background:var(--tip-title)}.notice.tip{background:var(--tip-content)}.icon-notice{display:inline-flex;align-self:center;margin-right:8px}.icon-notice img,.icon-notice svg{height:1em;width:1em;fill:currentColor}.icon-notice img,.icon-notice.baseline svg{top:.125em;position:relative}</style>
<div><svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg"><symbol id="tip-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/></symbol><symbol id="note-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="warning-notice" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet"><path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="info-notice" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"/></symbol></svg></div><div class="notice warning" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#warning-notice"></use></svg></span>Warning</p><p>注意是在开始菜单选择 <code>Restart</code> 而不能是选择 <code>Shut Down</code> 关机之后手动开机。</p></div>

<p>安装过程中系统会自动下载 Ubuntu 的子系统，重启后会弹出 ubuntu 的命令行初始界面，输入用户名和密码即可开始使用 ubuntu 子系统。</p>
<p>执行下面的指令设置 wsl 默认版本为 wsl2：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --set-default-version 2
</code></pre></div><h2 id="安装其他版本的子系统">安装其他版本的子系统<a hidden class="anchor" aria-hidden="true" href="#安装其他版本的子系统">#</a></h2>
<p>如果你想要其他版本的子系统，可以执行如下指令获取可通过 wsl 指令直接安装的发行版列表：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --list --online
</code></pre></div><p>返回数据类似下面这样：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">The following is a list of valid distributions that can be installed.
Install using <span style="color:#e6db74">&#39;wsl --install -d &lt;Distro&gt;&#39;</span>.

NAME            FRIENDLY NAME
Ubuntu          Ubuntu
Debian          Debian GNU/Linux
kali-linux      Kali Linux Rolling
openSUSE-42     openSUSE Leap 42
SLES-12         SUSE Linux Enterprise Server v12
Ubuntu-16.04    Ubuntu 16.04 LTS
Ubuntu-18.04    Ubuntu 18.04 LTS
Ubuntu-20.04    Ubuntu 20.04 LTS
</code></pre></div><p>如果想要安装某发行版，直接执行相应指令即可。例如可以通过下面的指令安装 <code>debian</code> 子系统：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --install -d Debian
</code></pre></div><p>当你安装了多个发行版，可以通过下面的指令指定默认发行版：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --setdefault &lt;Distro&gt;
</code></pre></div><p>例如，设置 Kali-linux 为默认发行版：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --setdefault Kali-linux
</code></pre></div><h2 id="安装-fedora-35">安装 fedora 35<a hidden class="anchor" aria-hidden="true" href="#安装-fedora-35">#</a></h2>
<p>wsl 提供的发行版中，并不包含 fedora 系统，所以只能手动安装。</p>
<h3 id="下载-fedora-镜像文件rootfs-image">下载 fedora 镜像文件(<strong>rootfs</strong> image)<a hidden class="anchor" aria-hidden="true" href="#下载-fedora-镜像文件rootfs-image">#</a></h3>
<p>在 <a href="https://koji.fedoraproject.org/koji/packageinfo?packageID=26387">Fedora-Container-Base</a> 选择需要的 fedora 版本下载。</p>
<p>在保证 <code>State</code> 一栏为 <code>complete</code> 的前提下找到需要的版本。</p>
<p><a href="https://koji.fedoraproject.org/koji/buildinfo?buildID=1921137">Fedora 35 build</a></p>
<p>我们要下载的文件是 <code>xz</code> 格式，同时选择正确的架构，如 <code>x86_64</code>。</p>
<p>(点击下面的链接直接下载)</p>
<p><a href="https://kojipkgs.fedoraproject.org/packages/Fedora-Container-Base/35/20220221.0/images/Fedora-Container-Base-35-20220221.0.x86_64.tar.xz">Fedora-Container-Base-35-20220221.0.x86_64.tar.xz</a></p>
<p>下载好之后解压这个压缩文件，如果你不知道用什么软件，下载使用 <a href="https://www.7-zip.org/download.html">7-Zip</a>。</p>
<div class="notice warning" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#warning-notice"></use></svg></span>Warning</p><p>注意，解压为 <code>tar</code> 文件即可，不要继续解压 <code>tar</code> 文件。</p></div>

<p>此时，查看你刚刚得到的 <code>tar</code> 文件，在里面找到一个名为 <code>layer.tar</code> 的文件，单独解压它，他就是我们需要的 rootfs image。把它解压到一个容易找到的位置，比如 <code>Downloads</code> 目录。为了便于使用，你可以将它重命名为 <code>fedora-35-rootfs.tar</code>。</p>
<p>如果你想要一些更加官方的系统镜像，可以在 <a href="https://github.com/fedora-cloud/docker-brew-fedora">docker-brew-fedora</a> 项目中找到你想要的文件。</p>
<p>直接在 <a href="https://github.com/fedora-cloud/docker-brew-fedora/branches/active">仓库</a> 中找到对应的版本和架构后下载对应的文件即可。比如，你可能下载了 <code>fedora-35-x86_64.tar.xz</code>，下载完成后，解压这个文件，得到 <code>tar</code> 文件，这个 <code>tar</code> 文件就是 rootfs image。如果愿意，你也可以将它重命名为 <code>fedora-35-rootfs.tar</code>。</p>
<h3 id="创建你的-wsl-存储目录">创建你的 wsl 存储目录<a hidden class="anchor" aria-hidden="true" href="#创建你的-wsl-存储目录">#</a></h3>
<p>创建一个文件夹来保存你的 wsl 文件。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">mkdir $HOME\wsl\fedora
</code></pre></div><h3 id="释放镜像文件">释放镜像文件<a hidden class="anchor" aria-hidden="true" href="#释放镜像文件">#</a></h3>
<p>假设你想要将子系统命名为 <code>fedora</code>，想要把它保存在 <code>$HOME\wsl\fedora</code> 目录下，同时 rootfs 文件存储在 <code>$HOME\Downloads\fedora-35-rootfs.tar</code>，执行下面的指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --import fedora $HOME\wsl\fedora $HOME\Downloads\fedora-35-rootfs.tar
</code></pre></div><h3 id="检查安装情况">检查安装情况<a hidden class="anchor" aria-hidden="true" href="#检查安装情况">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl -l
</code></pre></div><h3 id="使用-root-启动-fedora-子系统">使用 root 启动 fedora 子系统：<a hidden class="anchor" aria-hidden="true" href="#使用-root-启动-fedora-子系统">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl -d fedora
</code></pre></div><h3 id="设置-fedora-为默认发行版">设置 fedora 为默认发行版<a hidden class="anchor" aria-hidden="true" href="#设置-fedora-为默认发行版">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl -s fedora
</code></pre></div><h2 id="修复问题">修复问题<a hidden class="anchor" aria-hidden="true" href="#修复问题">#</a></h2>
<div class="notice info" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#info-notice"></use></svg></span>Info</p><p>注：以下问题是否存在取决于你下载的 fedora 版本，如果你没有对应错误直接跳过即可。</p></div>

<h3 id="挂载错误">挂载错误<a hidden class="anchor" aria-hidden="true" href="#挂载错误">#</a></h3>
<p>如果你在第一次启动 fedora 时得到了以下错误：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">An error occurred mounting one of your file systems. Please run <span style="color:#e6db74">&#39;dmesg&#39;</span> <span style="color:#66d9ef">for</span> more details.
</code></pre></div><p>这是由于系统缺少 mount 指令造成的，如果你不需要 mount 指令也不在意错误，完全可以忽略这个错误（虽然还是建议修一下）。</p>
<p>安装 <code>util-linux</code> 这个包即可。（如果你是一个极简主义者，安装 <code>util-linux-core</code> 这个包）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dnf install -y util-linux
</code></pre></div><p>安装完成后关闭 fedora 重启即可。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl -t fedora
</code></pre></div><h2 id="配置你的-fedora">配置你的 fedora<a hidden class="anchor" aria-hidden="true" href="#配置你的-fedora">#</a></h2>
<h3 id="升级系统">升级系统<a hidden class="anchor" aria-hidden="true" href="#升级系统">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dnf update
</code></pre></div><h3 id="创建用户">创建用户<a hidden class="anchor" aria-hidden="true" href="#创建用户">#</a></h3>
<p>继续之前，先安装下面的包：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">dnf install -y passwd cracklib-dicts
</code></pre></div><p>在 wheel 用户组下创建名为 <code>myusername</code> 的用户</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">useradd -G wheel myusername
</code></pre></div><p>为用户 <code>myusername</code> 设置密码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">passwd myusername
</code></pre></div><p>使用指定用户登录 wsl</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl -d fedora -u myusername
</code></pre></div><p>查看是否成功</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">whoami
</code></pre></div><p>检查是否具有 sudo 权限</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo cat /etc/shadow
</code></pre></div><h3 id="设置默认用户">设置默认用户<a hidden class="anchor" aria-hidden="true" href="#设置默认用户">#</a></h3>
<p>首先你的系统必须是 Windows build 18980 之后的版本，只需要 <a href="https://docs.microsoft.com/en-us/windows/wsl/wsl-config#user">修改 wsl 配置文件</a> 即可。</p>
<p>如果你没有创建过 <code>/etc/wsl.conf</code> 文件，直接执行如下指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">printf <span style="color:#e6db74">&#34;\n[user]\ndefault = myusername\n&#34;</span> | sudo tee -a /etc/wsl.conf
</code></pre></div><p>或者手动添加下面内容到 <code>/etc/wsl.conf</code>：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-toml" data-lang="toml">[<span style="color:#a6e22e">user</span>]
<span style="color:#a6e22e">default</span> = <span style="color:#a6e22e">myusername</span>
</code></pre></div><p>关闭 fedora 子系统。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl -t fedora
</code></pre></div><p>在不指定用户的情况下启动 fedora 子系统，检查用户是否正确。</p>
<h3 id="容器">容器<a hidden class="anchor" aria-hidden="true" href="#容器">#</a></h3>
<p>如果你需要运行容器，重新安装 <code>shadow-utils</code> 确保修复一些 rootfs 带来的错误：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo dnf reinstall -y shadow-utils
</code></pre></div><h3 id="ping">ping<a hidden class="anchor" aria-hidden="true" href="#ping">#</a></h3>
<p>如果你想要执行 ping 指令，执行下面的操作：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo dnf install -y procps-ng iputils
sudo sysctl -w net.ipv4.ping_group_range<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0 2000&#34;</span>
</code></pre></div><h3 id="常用指令">常用指令<a hidden class="anchor" aria-hidden="true" href="#常用指令">#</a></h3>
<p>安装下面的包来启用 Linux 下常用指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo dnf -y install iproute findutils ncurses initscripts
</code></pre></div><h3 id="编辑器">编辑器<a hidden class="anchor" aria-hidden="true" href="#编辑器">#</a></h3>
<p>安装必要的编辑器，你可以按照喜好选择 <code>vim</code> <code>nano</code> 或 <code>micro</code>。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo dnf install -y vim
</code></pre></div><h3 id="man">man<a hidden class="anchor" aria-hidden="true" href="#man">#</a></h3>
<p>继续之前首先要确保 <code>nodocs</code> 选项没有被开启，你可以手动编辑 <code>tsflags=nodocs</code> 这一行，也可以直接执行下面的指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">grep -v nodocs /etc/dnf/dnf.conf | sudo tee /etc/dnf/dnf.conf
</code></pre></div><p>接下来安装 man</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo dnf install -y man man-pages
</code></pre></div><p>安装完成之后，在这之后安装的软件就可以使用 <code>man</code> 指令查看文档了，但是之前已经安装好的软件，并不能查看文档，比如现在执行 <code>man dnf</code> 就不会得到任何结果。需要执行 <code>sudo dnf reinstall -y dnf</code> 重新安装 dnf 之后，才可以正确查看相关文档。</p>
<p>执行下面的指令重新安装全部的包：</p>
<div class="notice warning" >
<p class="first notice-title"><span class="icon-notice baseline"><svg><use href="#warning-notice"></use></svg></span>Warning</p><p>这一步非常费时，如果你不常用 man 可以选择跳过。</p></div>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#66d9ef">for</span> pkg in <span style="color:#66d9ef">$(</span>dnf repoquery --installed --qf <span style="color:#e6db74">&#34;%{name}&#34;</span><span style="color:#66d9ef">)</span>; <span style="color:#66d9ef">do</span> sudo dnf reinstall -qy $pkg; <span style="color:#66d9ef">done</span>
</code></pre></div><h3 id="允许调用-windows-的浏览器">允许调用 Windows 的浏览器<a hidden class="anchor" aria-hidden="true" href="#允许调用-windows-的浏览器">#</a></h3>
<p>首先安装 <a href="https://github.com/wslutilities/wslu">wslu</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo dnf copr enable wslutilities/wslu
sudo dnf install wslu
</code></pre></div><p>添加如下配置</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export BROWSER<span style="color:#f92672">=</span>wslview
</code></pre></div><h3 id="导出系统">导出系统<a hidden class="anchor" aria-hidden="true" href="#导出系统">#</a></h3>
<p>为了方便之后安装，可以将系统导出。</p>
<p>首先清理掉缓存文件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo dnf clean all
</code></pre></div><p>使用下面的指令导出 fedora 子系统到 <code>$HOME\Downloads\fedora-wsl.tar</code> 目录下。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --export fedora $HOME\Downloads\fedora-wsl.tar
</code></pre></div><p>之后要使用的时候，可以使用下面的指令导入：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">mkdir $HOME\wsl\freshfedora
wsl --import freshfedora $HOME\wsl\freshfedora $HOME\Downloads\fedora-wsl.tar
</code></pre></div><h2 id="wsl-常用指令">wsl 常用指令<a hidden class="anchor" aria-hidden="true" href="#wsl-常用指令">#</a></h2>
<h3 id="查看当前正在运行的子系统">查看当前正在运行的子系统<a hidden class="anchor" aria-hidden="true" href="#查看当前正在运行的子系统">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --list --running
</code></pre></div><h3 id="关闭指定子系统">关闭指定子系统<a hidden class="anchor" aria-hidden="true" href="#关闭指定子系统">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --terminate &lt;Distro&gt;
</code></pre></div><p>例如关闭正在运行的 Ubuntu 子系统：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --terminate Ubuntu
</code></pre></div><h3 id="关闭全部子系统">关闭全部子系统<a hidden class="anchor" aria-hidden="true" href="#关闭全部子系统">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --shutdown
</code></pre></div><h3 id="升级-wsl">升级 wsl<a hidden class="anchor" aria-hidden="true" href="#升级-wsl">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --update
</code></pre></div><h3 id="版本回滚">版本回滚<a hidden class="anchor" aria-hidden="true" href="#版本回滚">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --update --rollback
</code></pre></div><h3 id="删除子系统">删除子系统<a hidden class="anchor" aria-hidden="true" href="#删除子系统">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ps1" data-lang="ps1">wsl --unregister &lt;Distro&gt;
</code></pre></div><h2 id="wsl-使用技巧">wsl 使用技巧<a hidden class="anchor" aria-hidden="true" href="#wsl-使用技巧">#</a></h2>
<p>在文件资源管理器中输入 <code>\\wsl$</code> 即可进入 wsl 的目录。可以将它添加到文件资源管理器的网络路径里便于访问。</p>
<h2 id="参考">参考<a hidden class="anchor" aria-hidden="true" href="#参考">#</a></h2>
<blockquote>
<p><a href="https://dev.to/bowmanjd/install-fedora-on-windows-subsystem-for-linux-wsl-4b26">Install Fedora 36 or earlier on Windows Subsystem for Linux (WSL)</a></p>
</blockquote>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://aimerneige.com/zh/tags/wsl/">wsl</a></li>
      <li><a href="https://aimerneige.com/zh/tags/wsl2/">wsl2</a></li>
      <li><a href="https://aimerneige.com/zh/tags/fedora35/">fedora35</a></li>
      <li><a href="https://aimerneige.com/zh/tags/windows/">windows</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://aimerneige.com/zh/post/devops/how-to-setup-your-new-linux-server/">
    <span class="title">« 上一页</span>
    <br>
    <span>如何配置新购置的 Linux 服务器</span>
  </a>
  <a class="next" href="https://aimerneige.com/zh/post/linux/basic-usage-of-find/">
    <span class="title">下一页 »</span>
    <br>
    <span>find 指令的基本用法</span>
  </a>
</nav>

  </footer>
<div id="license">
    <p>
        This article is licensed under
        <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/" style="color: #00b5da">
            <u>CC-BY-NC-4.0</u>
        </a>
    </p>
</div>

<div id="comment">
    <script
        id="utterances"
        src="https://utteranc.es/client.js"
        repo="aimerneige/aimerneige.github.io"
        issue-term="title"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async
    ></script>
    <script>
        
        let ua = navigator.userAgent.toLocaleLowerCase();
        if (ua.match(/QQ/i) == "qq") {
            document.getElementById("utterances").remove();
        }
        if (ua.match(/MicroMessenger/i) == "micromessenger") {
            document.getElementById("utterances").remove();
        }
    </script>
</div>




</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://aimerneige.com/zh/">AimerNeige&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = '复制';

        function copyingDone() {
            copybutton.innerHTML = '已复制！';
            setTimeout(() => {
                copybutton.innerHTML = '复制';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
