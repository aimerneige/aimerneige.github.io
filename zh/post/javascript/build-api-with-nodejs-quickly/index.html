<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ä½¿ç”¨ nodejs å¿«é€Ÿä¸º Android ç¨‹åºæ„å»º API | Aimer&#39;s Blog</title>
<meta name="keywords" content="nodejs, javascript, api, mysql">
<meta name="description" content="ä½¿ç”¨ nodejs å¼€å‘ç®€å•åç«¯">
<meta name="author" content="Aimer Neige">
<link rel="canonical" href="https://aimerneige.com/zh/post/javascript/build-api-with-nodejs-quickly/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.1a3bc216084c4d25d9d2ad6194a81a9af705e37ffb312368d9619e5c97ac96a9.css" integrity="sha256-GjvCFghMTSXZ0q1hlKgamvcF43/7MSNo2WGeXJeslqk=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://aimerneige.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://aimerneige.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://aimerneige.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://aimerneige.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://aimerneige.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh" href="https://aimerneige.com/zh/post/javascript/build-api-with-nodejs-quickly/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5QJPQTJ618"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-5QJPQTJ618', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="ä½¿ç”¨ nodejs å¿«é€Ÿä¸º Android ç¨‹åºæ„å»º API" />
<meta property="og:description" content="ä½¿ç”¨ nodejs å¼€å‘ç®€å•åç«¯" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://aimerneige.com/zh/post/javascript/build-api-with-nodejs-quickly/" />
<meta property="og:image" content="https://aimerneige.com/images/nodejs.png" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2021-01-30T20:17:30+08:00" />
<meta property="article:modified_time" content="2021-01-30T20:17:30+08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://aimerneige.com/images/nodejs.png" />
<meta name="twitter:title" content="ä½¿ç”¨ nodejs å¿«é€Ÿä¸º Android ç¨‹åºæ„å»º API"/>
<meta name="twitter:description" content="ä½¿ç”¨ nodejs å¼€å‘ç®€å•åç«¯"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "æ–‡ç«  ğŸ“",
      "item": "https://aimerneige.com/zh/post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ä½¿ç”¨ nodejs å¿«é€Ÿä¸º Android ç¨‹åºæ„å»º API",
      "item": "https://aimerneige.com/zh/post/javascript/build-api-with-nodejs-quickly/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ä½¿ç”¨ nodejs å¿«é€Ÿä¸º Android ç¨‹åºæ„å»º API",
  "name": "ä½¿ç”¨ nodejs å¿«é€Ÿä¸º Android ç¨‹åºæ„å»º API",
  "description": "ä½¿ç”¨ nodejs å¼€å‘ç®€å•åç«¯",
  "keywords": [
    "nodejs", "javascript", "api", "mysql"
  ],
  "articleBody": "å‰è¨€ ä¹‹å‰åœ¨å­¦ä¹ å®‰å“çš„æ—¶å€™ï¼Œå¾ˆæƒ³è¦ç»™è‡ªå·±çš„è½¯ä»¶å¢åŠ ä¸€ä¸ªäº‘æœåŠ¡åŠŸèƒ½ï¼Œä½†æ˜¯è‹¦äºæ²¡æœ‰å­¦è¿‡åç«¯ï¼Œäºæ˜¯å¼€å§‹åœ¨äº’è”ç½‘ä¸ŠæŸ¥æ‰¾èµ„æ–™ã€‚ä½†æ˜¯é—æ†¾çš„æ˜¯ï¼Œåç«¯æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„èŒƒå›´ï¼Œæˆ‘æŸ¥æ‰¾äº†å¾ˆå¤šåç«¯çš„èµ„æ–™ä¹Ÿå‡ ä¹éƒ½æ˜¯åœ¨è®²è§£å¦‚ä½•å†™ç½‘é¡µï¼Œå¹¶æ²¡æœ‰ä¸“é—¨ç”¨æ¥ç»™å®‰å“å†™åç«¯çš„æ•™ç¨‹ï¼Œåœ¨å¹¿æ³›åœ°å­¦ä¹ äº†å¤§é‡åç«¯å†…å®¹åï¼ŒæˆåŠŸçš„ä¸ºè‡ªå·±çš„ç¨‹åºå¼€å‘äº†ä¸€ä¸ªç®€å•çš„ APIã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¤Ÿå¸®åˆ°é‚£äº›æ²¡æœ‰ç³»ç»Ÿåœ°å­¦ä¹ è¿‡åç«¯ï¼Œä½†æ˜¯å´æƒ³è¦å¿«é€Ÿå¼€å‘ä¸€æ¬¾èƒ½ç”¨çš„ API çš„å®‰å“å¼€å‘è€…ã€‚\nå‰æœŸå‡†å¤‡  ä½ è¦äº†è§£äº’è”ç½‘é€šè®¯åŸç† ä½ è¦ä¼šä¸€äº›åŸºç¡€çš„ JavaScript ä½ è¦æœ‰ä¸€å°æœåŠ¡å™¨ ä½ ä¼šæ•°æ®åº“æ“ä½œ æœ€å¥½æœ‰ä¸€ä¸ªåŸŸåï¼ˆéå¿…é¡»ï¼‰ æŒæ¡åŸºç¡€çš„ç»ˆç«¯æ“ä½œ  ç¯å¢ƒé…ç½® æœ¬æ–‡ç« ä¸­åç«¯å¼€å‘ä½¿ç”¨çš„å¼€å‘è¯­è¨€ä¸º JavaScript é…åˆ nodejsã€‚æ•°æ®åº“é‡‡ç”¨å¸¸ç”¨çš„ mysqlã€‚\n æ³¨ï¼š nodejs å¼€å‘å¸¸ç”¨çš„æ•°æ®åº“æ˜¯ mongodbï¼Œä½†æ˜¯ç”±äº mysql æ¯”è¾ƒå¸¸ç”¨è¿™é‡Œå°±ç”¨ mysql äº†ï¼Œå½“ç„¶å…¶ä»–æ•°æ®åº“ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½ å¯ä»¥æŸ¥æ‰¾ä¸€ä¸‹ nodejs å¦‚ä½•é“¾æ¥è¿™äº›æ•°æ®åº“ï¼Œå¹¶å°†æœ¬æ–‡ä¸­ mysql æ“ä½œçš„éƒ¨åˆ†æ›¿æ¢æ‰å°±å¯ä»¥äº†ã€‚\n æœ¬åœ°æµ‹è¯•å®¢æˆ·ç«¯å®‰è£… ä½ éœ€è¦åœ¨è‡ªå·±ç”¨æ¥å¼€å‘çš„ç”µè„‘ä¸Šå®‰è£…é…ç½®å¦‚ä¸‹ç¯å¢ƒï¼š\n nodejs npm  å®‰è£… nodejs Linux ä¸‹ç›´æ¥ä½¿ç”¨åŒ…ç®¡ç†å®‰è£…å³å¯ã€‚å¦‚æœåŒ…ç®¡ç†å®‰è£…çš„ node å¾ˆæ—§ï¼Œå¯ä»¥è‡ªè¡Œè°·æ­Œä¸€ä¸‹å®‰è£…æ–¹æ³•ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚\nä»¥ Ubuntu ä¸ºä¾‹ï¼Œç›´æ¥åœ¨ç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼š\nsudo apt install nodejs å®‰è£…å®Œæˆåä½¿ç”¨ node -v æŸ¥çœ‹ node ç‰ˆæœ¬æ¥ç¡®è®¤å®‰è£…æ˜¯å¦æˆåŠŸã€‚\nå¦‚æœæ˜¯ windows ç”¨æˆ·å°±æ›´åŠ ç®€å•äº†ï¼Œç›´æ¥åœ¨ nodejs å®˜ç½‘ ä¸‹è½½å®‰è£…åŒ…è¿è¡Œå³å¯ã€‚æ¨èä½¿ç”¨é•¿å‘¨æœŸç¨³å®šç‰ˆæœ¬ã€‚å¦‚æœä½ æƒ³ä½“éªŒæ–°ç‰¹æ€§ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨æœ€æ–°çš„ç‰ˆæœ¬ã€‚\nå®‰è£… npm é€šå¸¸æƒ…å†µä¸‹ï¼Œå®‰è£… nodejs æ—¶ä¼šé™„å¸¦å®‰è£… npmï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ npm -v æ¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿå®‰è£…çš„ npm ç‰ˆæœ¬æ¥æ£€æµ‹å®‰è£…æƒ…å†µã€‚\nå¦‚æœæ²¡æœ‰å®‰è£…ï¼Œä»¥ Ubuntu ç³»ç»Ÿä¸ºä¾‹ï¼Œå¯ä»¥åœ¨ç»ˆç«¯æ‰§è¡Œä¸‹é¢çš„æŒ‡ä»¤ï¼š\nsudo apt install npm windows ç”¨æˆ·åœ¨æ‰§è¡Œå®Œ node çš„å®‰è£…ç¨‹åºå npm  ä¼šè‡ªåŠ¨å®‰è£…å®Œæˆã€‚\næœåŠ¡å™¨å®‰è£… ä½ éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…é…ç½®å¦‚ä¸‹ç¯å¢ƒï¼š\n nodejs npm mysql nginx  å®‰è£… nodejs ä¸ npm å…¶ä¸­ nodejs å’Œ npm çš„å®‰è£…åŒå®¢æˆ·ç«¯å®Œå…¨ç›¸åŒï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚\nå®‰è£… mysql mysql å¯ä»¥ä¸€å¹¶å®‰è£…åœ¨è¿è¡Œ node é¡¹ç›®çš„æœåŠ¡å™¨ä¸Šï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç‹¬ç«‹çš„æ•°æ®åº“æä¾›æœåŠ¡å™¨ã€‚\næœ¬æ–‡ç« ä¸»è¦è®¨è®ºå¦‚ä½•æ„å»º API ï¼Œè¿™é‡Œä¸å†èµ˜è¿°å¦‚ä½•å®‰è£…é…ç½® mysqlã€‚å¯ä»¥æŸ¥çœ‹æˆ‘çš„å…¶ä»–æ–‡ç« ã€‚\nå®‰è£… nginx nginx ç”¨äºå°†æœåŠ¡åå‘ä»£ç†åˆ° 80 ç«¯å£ï¼Œä»¥ Ubuntu ç³»ç»Ÿä¸ºä¾‹ï¼Œç›´æ¥åœ¨ç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼š\nsudo apt install nginx Windows ç”¨æˆ·è‡ªè¡ŒæŸ¥é˜…ç›¸å…³èµ„æ–™ã€‚ä¸ä¼šå§ï¼Œä¸ä¼šå§ï¼Œä¸ä¼šæœ‰äººæœåŠ¡å™¨ç”¨ windows å§ï¼Ÿï¼Ÿé¡¹ç›®æ„å»º ä½¿ç”¨æ¨¡ç‰ˆ ä¸ºäº†æ–¹ä¾¿å¿«é€Ÿæ„å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæˆ‘å†™äº†ä¸€ä¸ªæ¨¡ç‰ˆï¼Œä½ å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°å®ƒã€‚\nä½¿ç”¨è¿™ä¸ªæ¨¡ç‰ˆå¿«é€Ÿæ„å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œå°†å®ƒ clone åˆ°æœ¬åœ°ï¼Œå¹¶è¿›è¡Œä¸‹é¢çš„ä¿®æ”¹ï¼š\n ä¿®æ”¹ package.json ä¿®æ”¹ LICENSE ä¿®æ”¹ README åœ¨ src/config ä¸‹æ–°å»º db.js å†™å…¥æ•°æ®åº“æœåŠ¡å™¨çš„é…ç½®ã€‚  å®‰è£…ä¾èµ– åœ¨é¡¹ç›®è·¯å¾„ä¸‹å¯åŠ¨ç»ˆç«¯ï¼Œæ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼š\nnpm i è¿™ä¸ªæŒ‡ä»¤æ˜¯ npm install çš„ç¼©å†™ï¼Œnpm ä¼šå®‰è£…éœ€è¦çš„ä¾èµ–ï¼Œæœ¬æ¨¡ç‰ˆé¡¹ç›®åªä¾èµ–äº†ä¿©ä¸ªåŒ…ï¼š\n express mysql  ä¾èµ–å®‰è£…å®Œæˆåï¼Œä½ ä¼šåœ¨é¡¹ç›®è·¯å¾„ä¸‹çœ‹åˆ° node_modules è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œå®ƒå·²ç»è¢«å†™åœ¨ .gitignore ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹æ˜¯é¡¹ç›®æ‰€éœ€è¦çš„ä¾èµ–ï¼Œå³ä½¿ä½ æ„å¤–åœ°åˆ æ‰äº†è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œå†æ¬¡æ‰§è¡Œ npm i å°±å¯ä»¥å°†è¿™äº›æ–‡ä»¶ä¸‹è½½å›æ¥ï¼Œæ‰€ä»¥ä½ ä¸åº”è¯¥åœ¨æ„è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­æœ‰ä»€ä¹ˆå†…å®¹ï¼Œnpm ä¼šå¸®æˆ‘ä»¬å¤„ç†å®ƒã€‚\nå¯åŠ¨é¡¹ç›® ä½¿ç”¨ cd å‘½ä»¤åˆ‡æ¢åˆ° src ç›®å½•ä¸‹ï¼Œæ‰§è¡Œä¸‹é¢çš„æŒ‡ä»¤ï¼š\nnode app.js ä¹‹åä½ ä¼šåœ¨ç»ˆç«¯çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š\nServer start in development mode on http://localhost:4000; press Ctrl + C to terminated. æ‰“å¼€ä½ çš„æµè§ˆå™¨è®¿é—® http://localhost:4000/\nå¦‚æœä½ çœ‹åˆ°ä¸‹é¢çš„å†…å®¹ï¼Œè¯´æ˜é¡¹ç›®æˆåŠŸå¯åŠ¨äº†ï¼š\n{ \"status\": 200, \"info\": \"If you see this, the server deploy success!\" } å¦‚æœä½ åœ¨æœåŠ¡å™¨å¯åŠ¨é¡¹ç›®ï¼Œå‡è®¾ä½ çš„æœåŠ¡å™¨ ip ä¸º 43.192.82.215 å¹¶ä¸”é…ç½®äº†åŸŸå api.aimerneige.com ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨æµè§ˆå™¨å†…è®¿é—®ä¸‹é¢çš„åœ°å€æµ‹è¯•æœåŠ¡å™¨ï¼š\n http://43.192.82.215:4000/ http://api.aimerneige.com:4000/  æ³¨æ„ï¼š\n åœ¨æœ¬åœ°æµ‹è¯•å¯åŠ¨çš„æœåŠ¡å™¨åªèƒ½é€šè¿‡ æœ¬åœ°/å†…ç½‘ è®¿é—® åœ¨æœ‰å…¬ç½‘ ip çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²çš„æœåŠ¡å¯ä»¥åœ¨ ä»»æ„æµè§ˆå™¨å†… æ‰“å¼€  å¦‚æœä½ åœ¨æœåŠ¡å™¨æµ‹è¯•ï¼Œè¯·æ³¨æ„ä»¥è¿™æ ·çš„æ–¹å¼è¿è¡Œä»…èƒ½ç”¨æ¥æµ‹è¯•ï¼Œä¸å¯ä»¥ç”¨ä½œç”Ÿäº§ç¯å¢ƒï¼Œåæ–‡ä¼šä»‹ç»å¦‚ä½•åœ¨æœåŠ¡å™¨éƒ¨ç½²é¡¹ç›®ã€‚\nç¨‹åºå…¥å£ é¡¹ç›®å¯ä»¥å¯åŠ¨åï¼Œè¯´æ˜ç¯å¢ƒé…ç½®æ— è¯¯ï¼Œæ¥ä¸‹æ¥å¯ä»¥å¼€å§‹å†™ä»£ç äº†ã€‚\næˆ‘ä»¬ç®€å•çœ‹ä¸€ä¸‹ç¨‹åºçš„å…¥å£ app.js\næœ¬é¡¹ç›®ä¾èµ– express æ„å»ºï¼Œé¦–å…ˆå¯¼å…¥ express çš„æ¨¡å—ï¼š\n// require const express = require(\"express\"); æ¥ä¸‹æ¥å¯¼å…¥è·¯ç”±ç›®å½•ä¸‹çš„è·¯ç”±æ¨¡å—ï¼š\n// user require const indexRouter = require(\"./routes/index\"); åˆ›å»º express å¯¹è±¡ï¼š\n// express app var app = express(); è®¾ç½®ç›‘å¬ç«¯å£ï¼š\n// set port app.set(\"port\", process.env.PORT || 4000); æ·»åŠ å¯ä»¥æ”¯æŒ json è§£æçš„ä¸­é—´ä»¶ï¼š\n// json parse app.use(express.json()); app.use(express.urlencoded({ extended: false })); æ·»åŠ è·¯ç”±ä¸­é—´ä»¶ï¼š\n// routes app.use(\"/\", indexRouter); è·¯ç”±åŒ¹é…å¤±è´¥åè¿”å› 404 é”™è¯¯ï¼š\n// catch 404 and forward to error handler app.use(function (req, res, next) {  var err = new Error(\"Not Found\");  err.status = 404;  next(err); }); å¤„ç†é”™è¯¯ä¿¡æ¯ï¼š\n// error handler app.use(function (err, req, res, next) {  res.type(\"application/json\");  res.status(err.status || 500);  res.send({  status: err.status || 500,  message: err.message,  }); }); æ£€æµ‹å½“å‰æ¨¡å—æ˜¯å¦è¢«ç›´æ¥æ‰§è¡Œï¼Œå¦‚æœæ˜¯åˆ™å¯åŠ¨æœåŠ¡å™¨ï¼Œå¦è€…å¯¼å‡ºæ¨¡å—ï¼š\n// check if run app.js directly if (require.main === module) {  app.listen(app.get(\"port\"), function () {  console.log(  \"Server start in \" +  app.get(\"env\") +  \" mode on http://localhost:\" +  app.get(\"port\") +  \"; press Ctrl + C to terminated.\"  );  }); } else {  module.exports = app; } å…¶ä»–çš„ä»£ç å¯ä»¥æš‚æ—¶ä¸å»ç†ä¼šï¼Œæœ€é‡è¦çš„æ˜¯è·¯ç”±è¿™ä¸€éƒ¨åˆ†ï¼š\n// å¯¼å…¥è·¯ç”±æ¨¡å— const indexRouter = require(\"./routes/index\"); // æ·»åŠ è·¯ç”±ä¸­é—´ä»¶ app.use(\"/\", indexRouter); åœ¨ç¼–å†™ api æ—¶ï¼Œåªéœ€è¦åœ¨ /src/routes ç›®å½•ä¸‹æ–°å»ºè·¯ç”±æ¨¡å—ï¼Œå¹¶åœ¨ app.js ä¸‹å¼•ç”¨å³å¯ã€‚\næ·»åŠ è·¯ç”± æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹é»˜è®¤çš„è·¯ç”±æ¨¡å— index.js ï¼š\nå¯¼å…¥ express æ¨¡å—ï¼š\nconst express = require(\"express\"); const router = express.Router(); é…ç½®è·¯ç”±è§„åˆ™ï¼š\nrouter.get(\"/\", function (req, res, next) {  res.type(\"application/json\");  res.status(200);  res.send({  status: 200,  info: \"If you see this, the server deploy success!\",  }); }); å¯¼å‡ºæ¨¡å—ï¼š\nmodule.exports = router; å…¶ä¸­é‡ç‚¹å³é…ç½®è·¯ç”±è§„åˆ™è¿™ä¸€éƒ¨åˆ†ã€‚\næˆ‘ç›¸ä¿¡è¿™å‡ è¡Œä»£ç è¿˜æ˜¯å¾ˆæ˜“æ‡‚çš„ï¼Œç›¸å¯¹åœ°ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ä½¿ç”¨ post æ–¹æ³•ï¼Œè®¿é—®è·¯å¾„ä¸º /about éœ€è¦è¿™æ ·å†™ï¼š\nrouter.post(\"/about\", fuction(){ /* function */ } ); è®¾ç½®å¥½è¯·æ±‚æ–¹æ³•å’Œè¯·æ±‚è·¯å¾„åï¼Œå›è°ƒå‡½æ•°ç”¨æ¥å‘å®¢æˆ·ç«¯è¿”å›æ•°æ®ã€‚\nè®¾ç½®è¿”å›æ•°æ®ç±»å‹ï¼Œè¿™é‡Œä½¿ç”¨ json è¿›è¡Œæ•°æ®ä¼ è¾“ï¼š\nres.type(\"application/json\"); è®¾ç½®è¿”å›çŠ¶æ€ç ï¼š\nres.status(200); è¿”å›æŒ‡å®šæ•°æ®ï¼š\nres.send(return_data); ç”±äºå¼€å‘è¯­è¨€ä¸º js ï¼Œè€Œä¸”æœ¬é¡¹ç›®æ·»åŠ äº†è§£æ json çš„ä¸­é—´ä»¶ï¼Œå¦‚æœæƒ³è¦è¿”å› jsonï¼Œä¸éœ€åƒå…¶ä»–è¯­è¨€é‚£æ ·è¦å°†å¯¹è±¡è§£æä¸º json å­—ç¬¦ä¸²ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡å³å¯ï¼Œå®¢æˆ·ç«¯ä¼šæˆåŠŸæ¥æ”¶åˆ°æ­£ç¡®çš„ json å­—ç¬¦ä¸²ã€‚\n// æœåŠ¡å™¨è¿”å›çš„å¯¹è±¡ {  status: 200,  info: \"If you see this, the server deploy success!\", } // å®¢æˆ·ç«¯æ‹¿åˆ°çš„å­—ç¬¦ä¸² { \"status\": 200, \"info\": \"If you see this, the server deploy success!\" } ä¹¦å†™å¥½è·¯ç”±æ¨¡å—ååœ¨ app.js ä¸­å¼•ç”¨å³å¯ï¼š\n// å¯¼å…¥æ¨¡å— const indexRouter = require(\"./routes/index\");  // ... ä¸­é—´çš„å…¶ä»–ä»£ç   // åœ¨ app ä¸­åº”ç”¨è·¯ç”±æ¨¡å— app.use(\"/\", indexRouter); è¦æ³¨æ„æ¨¡å—å¯¼å…¥çš„ä½ç½®ï¼Œä¸èƒ½ä¹±æ”¾ã€‚å’Œæ¨¡ç‰ˆä¿æŒä¸€è‡´å³å¯ã€‚\næ·»åŠ æ›´å¤šçš„è·¯ç”±ä¿¡æ¯ å°±åƒä¸Šé¢çš„ä¾‹å­ä¸­æ‰€å†™çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·»åŠ æ–°çš„è·¯ç”±æ¨¡å—ï¼Œä¹Ÿå¯ä»¥åœ¨åŒä¸€ä¸ªè·¯ç”±æ¨¡å—ä¸‹æ·»åŠ æ›´å¤šçš„è®¿é—®è·¯å¾„ã€‚\n src/app.js  // ...  const indexRouter = require(\"./routes/index\"); const userRouter = require(\"./routes/user\");  // ...  app.use(\"/\", indexRouter); app.use(\"/user\", userRouter);  src/routes/index.js  // ...  // è®¿é—®è·¯å¾„ / router.get(\"/\", fuction(){ /* function */ } );  // è®¿é—®è·¯å¾„ /about router.get(\"/about\", function() { /* function */ });  // ...  src/routes/user.js  // ...  // è®¿é—®è·¯å¾„ /user/cat router.get(\"/cat\", fuction(){ /* function */ } );  // è®¿é—®è·¯å¾„ /user/edit router.post(\"/edit\", fuction(){ /* function */ } );  // è®¿é—®è·¯å¾„ /user/new router.psot(\"/new\", fuction(){ /* function */ } );  // ... è·å–å®¢æˆ·ç«¯æ•°æ® è·å–è¯·æ±‚å‚æ•°ä¿¡æ¯ req.query å¯¹è±¡æ˜¯ç”±å®¢æˆ·ç«¯è¯·æ±‚å‚æ•°æ„æˆçš„ï¼Œåœ¨å›è°ƒå‡½æ•°å†…ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨å®ƒæ¥è·å–å®¢æˆ·ç«¯è¯·æ±‚å‚æ•°ï¼Œå¦‚æœå®¢æˆ·ç«¯ä¼ é€’äº†å‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°å¯¹åº”çš„æ•°æ®ï¼Œå¦è€…æˆ‘ä»¬åªèƒ½å¾—åˆ° undefinedã€‚ç”±æ­¤å¯ä»¥é€šè¿‡åˆ¤ç©ºæ¥ç¡®å®šå®¢æˆ·ç«¯è¯·æ±‚å‚æ•°æ˜¯å¦æ­£ç¡®ã€‚\nä¾‹å¦‚æˆ‘ä»¬çš„è¯·æ±‚è·¯å¾„ä¸º /data æ‰€éœ€è¯·æ±‚å‚æ•°ä¸º id å’Œ class å¯ä»¥è¿™æ ·å†™ï¼š\n æ³¨ï¼š å¯¹åº”çš„ç¤ºä¾‹è¯·æ±‚åœ°å€ä¸º https://api.example.com/data?id=1930201\u0026class=302\n router.get(\"/data\", function (req, res) {  res.type(\"application/json\");  if (req.query.class === undefined || req.query.id === undefined) {  res.status(400);  // å‘å®¢æˆ·ç«¯è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæç¤ºå®¢æˆ·ç«¯è¿”å›æ­£ç¡®çš„å‚æ•°  res.send({  status: 400,  info: \"Wrong arguments!\",  });  } else {  // å‘ç”¨æˆ·è¿”å›æ•°æ®ï¼ˆé€šå¸¸ä¼šç”¨å®¢æˆ·ç«¯å‚æ•°æ¥è°ƒç”¨æ•°æ®åº“ï¼Œä¸ºäº†ç®€ä¾¿è¿™é‡Œè¿”å›ä¸€ä¸ªç±»åšç®€å•ç¤ºèŒƒï¼‰  res.status(200);  res.send({  status: 200,  info: {  class: req.query.class,  id: req.query.id,  },  });  } }); æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ¤ç©ºæ¥ç¡®å®šå®¢æˆ·ç«¯è¯·æ±‚å‚æ•°æ˜¯å¦æ­£ç¡®ï¼Œä¹‹åå¯ä»¥ä½¿ç”¨å‚æ•°æ¥è¿›è¡Œå…¶ä»–æ“ä½œï¼Œæ¯”å¦‚æ„å»ºç±»ï¼Œè°ƒå–æ•°æ®åº“ç­‰ç­‰ã€‚\nè·å–è¯·æ±‚ä½“ä¿¡æ¯ ä¸è¯·æ±‚å‚æ•°ç±»ä¼¼ï¼Œè¯·æ±‚ä½“ä¿¡æ¯ä¹Ÿä¿å­˜åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œå°±æ˜¯ req.bodyã€‚ä½¿ç”¨æ–¹æ³•å’Œä¹‹å‰è¯·æ±‚å‚æ•°å®Œå…¨ä¸€è‡´ï¼Œè¿™é‡Œåªå†™ä¸€ä¸ªç¤ºä¾‹ï¼Œä¸å¤šèµ˜è¿°ã€‚\nrouter.post(\"/new\", function (req, res) {  res.type(\"application/json\");  if (req.body.class === undefined || req.body.id === undefined) {  res.status(400);  // å‘å®¢æˆ·ç«¯è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæç¤ºå®¢æˆ·ç«¯è¿”å›æ­£ç¡®çš„å‚æ•°  res.send({  status: 400,  info: \"Wrong arguments!\",  });  } else {  var new_student = {  class: req.body.class,  id: req.body.id,  };  // å‘æ•°æ®åº“å†…æ·»åŠ æ–°çš„å­¦ç”Ÿ  res.status(200);  res.send({  status: 200,  info: \"Student create successful!\",  });  } }); è·å–æ›´å¤šä¿¡æ¯ åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œreq å¯¹è±¡ä¸­ä¿å­˜äº†æ‰€æœ‰æ¥è‡ªå®¢æˆ·è¯·æ±‚çš„æ•°æ®ï¼Œå‰é¢ä»‹ç»çš„åªæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ï¼Œå…¶ä»–å†…å®¹å¯ä»¥æŸ¥æ‰¾æ–‡æ¡£ã€‚\nè·å–æ•°æ®åº“ä¿¡æ¯ é…ç½®æ•°æ®åº“ä¿¡æ¯ å‚è€ƒ db.js.example åˆ›å»º db.js å†™å…¥æœåŠ¡å™¨çš„é…ç½®\nvar mysql = require(\"mysql\");  var pool = mysql.createPool({  host: \"host_ip\",  user: \"user_name\",  password: \"password\",  database: \"data\",  port: 3306, });  function query(sql, callback) {  pool.getConnection(function (err, connection) {  connection.query(sql, function (err, rows) {  callback(err, rows);  connection.release();  });  }); }  exports.query = query; é…ç½®å¥½æ•°æ®åº“æœåŠ¡å™¨åï¼Œå°±å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•è®¿é—®æ•°æ®åº“çš„æ•°æ®äº†ï¼š\nsql_command = \"DROP DATABASE *;\"; // âš ï¸ æ³¨æ„ä¿®æ”¹ db.query(sql_command, function (err, result, fields) {  if (err) {  // å¦‚æœæ•°æ®åº“æŒ‡ä»¤æ‰§è¡Œå‡ºç°äº†é”™è¯¯ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯  requestSQLFailedLog(sql_command, err);  res.status(400);  res.send({ status: 400, info: err });  } else {  // å¦‚æœæ•°æ®åº“æŒ‡ä»¤æ‰§è¡ŒæˆåŠŸï¼Œè¿”å›æ•°æ®  requestSQLSuccessLog(sql_command, result);  res.status(200);  res.send(result);  } }); æœåŠ¡éƒ¨ç½²  å¾…å®Œå–„ï¼Œå’•å’•å’•\n  å°†é¡¹ç›®ä¸Šä¼ åˆ°æœåŠ¡å™¨ ä¿®æ”¹ db.js çš„é…ç½® cd src node cluster.js å¦‚æœä½ æƒ³è¦åå°è¿è¡Œï¼Œæ‰§è¡Œ nohup node cluster.js \u0026  ",
  "wordCount" : "813",
  "inLanguage": "zh",
  "image":"https://aimerneige.com/images/nodejs.png","datePublished": "2021-01-30T20:17:30+08:00",
  "dateModified": "2021-01-30T20:17:30+08:00",
  "author":{
    "@type": "Person",
    "name": "Aimer Neige"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://aimerneige.com/zh/post/javascript/build-api-with-nodejs-quickly/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Aimer's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://aimerneige.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://aimerneige.com/zh/" accesskey="h" title="Aimer&#39;s Blog (Alt + H)">Aimer&#39;s Blog</a>
            <div class="logo-switches">
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://aimerneige.com/en/" title="English"
                            aria-label="English">English</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://aimerneige.com/zh/about/" title="å…³äº">
                    <span>å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://aimerneige.com/zh/post/" title="æ–‡ç« ">
                    <span>æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://aimerneige.com/zh/archives/" title="å½’æ¡£">
                    <span>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="https://aimerneige.com/zh/tags/" title="æ ‡ç­¾">
                    <span>æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://aimerneige.com/zh/categories/" title="åˆ†ç±»">
                    <span>åˆ†ç±»</span>
                </a>
            </li>
            <li>
                <a href="https://aimerneige.com/zh/search/" title="æœç´¢">
                    <span>æœç´¢</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://aimerneige.com/zh/">ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="https://aimerneige.com/zh/post/">æ–‡ç«  ğŸ“</a></div>
    <h1 class="post-title">
      ä½¿ç”¨ nodejs å¿«é€Ÿä¸º Android ç¨‹åºæ„å»º API
    </h1>
    <div class="post-description">
      ä½¿ç”¨ nodejs å¼€å‘ç®€å•åç«¯
    </div>
    <div class="post-meta"><span title='2021-01-30 20:17:30 +0800 CST'>ä¸€æœˆ 30, 2021</span>&nbsp;Â·&nbsp;Aimer Neige&nbsp;|&nbsp;<a href="https://github.com/aimerneige/blog/edit/master/content/post/JavaScript/build-api-with-nodejs-quickly.zh.md" rel="noopener noreferrer" target="_blank">Suggest Changes</a>

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://aimerneige.com/images/nodejs.png" alt="nodejs logo">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%89%8d%e8%a8%80" aria-label="å‰è¨€">å‰è¨€</a></li>
                <li>
                    <a href="#%e5%89%8d%e6%9c%9f%e5%87%86%e5%a4%87" aria-label="å‰æœŸå‡†å¤‡">å‰æœŸå‡†å¤‡</a></li>
                <li>
                    <a href="#%e7%8e%af%e5%a2%83%e9%85%8d%e7%bd%ae" aria-label="ç¯å¢ƒé…ç½®">ç¯å¢ƒé…ç½®</a><ul>
                        
                <li>
                    <a href="#%e6%9c%ac%e5%9c%b0%e6%b5%8b%e8%af%95%e5%ae%a2%e6%88%b7%e7%ab%af%e5%ae%89%e8%a3%85" aria-label="æœ¬åœ°æµ‹è¯•å®¢æˆ·ç«¯å®‰è£…">æœ¬åœ°æµ‹è¯•å®¢æˆ·ç«¯å®‰è£…</a><ul>
                        
                <li>
                    <a href="#%e5%ae%89%e8%a3%85-nodejs" aria-label="å®‰è£… nodejs">å®‰è£… nodejs</a></li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85-npm" aria-label="å®‰è£… npm">å®‰è£… npm</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%ae%89%e8%a3%85" aria-label="æœåŠ¡å™¨å®‰è£…">æœåŠ¡å™¨å®‰è£…</a><ul>
                        
                <li>
                    <a href="#%e5%ae%89%e8%a3%85-nodejs-%e4%b8%8e-npm" aria-label="å®‰è£… nodejs ä¸ npm">å®‰è£… nodejs ä¸ npm</a></li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85-mysql" aria-label="å®‰è£… mysql">å®‰è£… mysql</a></li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85-nginx" aria-label="å®‰è£… nginx">å®‰è£… nginx</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#%e9%a1%b9%e7%9b%ae%e6%9e%84%e5%bb%ba" aria-label="é¡¹ç›®æ„å»º">é¡¹ç›®æ„å»º</a><ul>
                        
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e6%a8%a1%e7%89%88" aria-label="ä½¿ç”¨æ¨¡ç‰ˆ">ä½¿ç”¨æ¨¡ç‰ˆ</a></li>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85%e4%be%9d%e8%b5%96" aria-label="å®‰è£…ä¾èµ–">å®‰è£…ä¾èµ–</a></li>
                <li>
                    <a href="#%e5%90%af%e5%8a%a8%e9%a1%b9%e7%9b%ae" aria-label="å¯åŠ¨é¡¹ç›®">å¯åŠ¨é¡¹ç›®</a></li>
                <li>
                    <a href="#%e7%a8%8b%e5%ba%8f%e5%85%a5%e5%8f%a3" aria-label="ç¨‹åºå…¥å£">ç¨‹åºå…¥å£</a></li>
                <li>
                    <a href="#%e6%b7%bb%e5%8a%a0%e8%b7%af%e7%94%b1" aria-label="æ·»åŠ è·¯ç”±">æ·»åŠ è·¯ç”±</a></li>
                <li>
                    <a href="#%e6%b7%bb%e5%8a%a0%e6%9b%b4%e5%a4%9a%e7%9a%84%e8%b7%af%e7%94%b1%e4%bf%a1%e6%81%af" aria-label="æ·»åŠ æ›´å¤šçš„è·¯ç”±ä¿¡æ¯">æ·»åŠ æ›´å¤šçš„è·¯ç”±ä¿¡æ¯</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96%e5%ae%a2%e6%88%b7%e7%ab%af%e6%95%b0%e6%8d%ae" aria-label="è·å–å®¢æˆ·ç«¯æ•°æ®">è·å–å®¢æˆ·ç«¯æ•°æ®</a><ul>
                        
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96%e8%af%b7%e6%b1%82%e5%8f%82%e6%95%b0%e4%bf%a1%e6%81%af" aria-label="è·å–è¯·æ±‚å‚æ•°ä¿¡æ¯">è·å–è¯·æ±‚å‚æ•°ä¿¡æ¯</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96%e8%af%b7%e6%b1%82%e4%bd%93%e4%bf%a1%e6%81%af" aria-label="è·å–è¯·æ±‚ä½“ä¿¡æ¯">è·å–è¯·æ±‚ä½“ä¿¡æ¯</a></li>
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96%e6%9b%b4%e5%a4%9a%e4%bf%a1%e6%81%af" aria-label="è·å–æ›´å¤šä¿¡æ¯">è·å–æ›´å¤šä¿¡æ¯</a></li></ul>
                </li>
                <li>
                    <a href="#%e8%8e%b7%e5%8f%96%e6%95%b0%e6%8d%ae%e5%ba%93%e4%bf%a1%e6%81%af" aria-label="è·å–æ•°æ®åº“ä¿¡æ¯">è·å–æ•°æ®åº“ä¿¡æ¯</a><ul>
                        
                <li>
                    <a href="#%e9%85%8d%e7%bd%ae%e6%95%b0%e6%8d%ae%e5%ba%93%e4%bf%a1%e6%81%af" aria-label="é…ç½®æ•°æ®åº“ä¿¡æ¯">é…ç½®æ•°æ®åº“ä¿¡æ¯</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#%e6%9c%8d%e5%8a%a1%e9%83%a8%e7%bd%b2" aria-label="æœåŠ¡éƒ¨ç½²">æœåŠ¡éƒ¨ç½²</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="å‰è¨€">å‰è¨€<a hidden class="anchor" aria-hidden="true" href="#å‰è¨€">#</a></h2>
<p>ä¹‹å‰åœ¨å­¦ä¹ å®‰å“çš„æ—¶å€™ï¼Œå¾ˆæƒ³è¦ç»™è‡ªå·±çš„è½¯ä»¶å¢åŠ ä¸€ä¸ªäº‘æœåŠ¡åŠŸèƒ½ï¼Œä½†æ˜¯è‹¦äºæ²¡æœ‰å­¦è¿‡åç«¯ï¼Œäºæ˜¯å¼€å§‹åœ¨äº’è”ç½‘ä¸ŠæŸ¥æ‰¾èµ„æ–™ã€‚ä½†æ˜¯é—æ†¾çš„æ˜¯ï¼Œåç«¯æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„èŒƒå›´ï¼Œæˆ‘æŸ¥æ‰¾äº†å¾ˆå¤šåç«¯çš„èµ„æ–™ä¹Ÿå‡ ä¹éƒ½æ˜¯åœ¨è®²è§£å¦‚ä½•å†™ç½‘é¡µï¼Œå¹¶æ²¡æœ‰ä¸“é—¨ç”¨æ¥ç»™å®‰å“å†™åç«¯çš„æ•™ç¨‹ï¼Œåœ¨å¹¿æ³›åœ°å­¦ä¹ äº†å¤§é‡åç«¯å†…å®¹åï¼ŒæˆåŠŸçš„ä¸ºè‡ªå·±çš„ç¨‹åºå¼€å‘äº†ä¸€ä¸ªç®€å•çš„ APIã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¤Ÿå¸®åˆ°é‚£äº›æ²¡æœ‰ç³»ç»Ÿåœ°å­¦ä¹ è¿‡åç«¯ï¼Œä½†æ˜¯å´æƒ³è¦å¿«é€Ÿå¼€å‘ä¸€æ¬¾èƒ½ç”¨çš„ API çš„å®‰å“å¼€å‘è€…ã€‚</p>
<h2 id="å‰æœŸå‡†å¤‡">å‰æœŸå‡†å¤‡<a hidden class="anchor" aria-hidden="true" href="#å‰æœŸå‡†å¤‡">#</a></h2>
<ol>
<li>ä½ è¦äº†è§£äº’è”ç½‘é€šè®¯åŸç†</li>
<li>ä½ è¦ä¼šä¸€äº›åŸºç¡€çš„ <code>JavaScript</code></li>
<li>ä½ è¦æœ‰ä¸€å°æœåŠ¡å™¨</li>
<li>ä½ ä¼šæ•°æ®åº“æ“ä½œ</li>
<li>æœ€å¥½æœ‰ä¸€ä¸ªåŸŸåï¼ˆéå¿…é¡»ï¼‰</li>
<li>æŒæ¡åŸºç¡€çš„ç»ˆç«¯æ“ä½œ</li>
</ol>
<h2 id="ç¯å¢ƒé…ç½®">ç¯å¢ƒé…ç½®<a hidden class="anchor" aria-hidden="true" href="#ç¯å¢ƒé…ç½®">#</a></h2>
<p>æœ¬æ–‡ç« ä¸­åç«¯å¼€å‘ä½¿ç”¨çš„å¼€å‘è¯­è¨€ä¸º <code>JavaScript</code> é…åˆ <code>nodejs</code>ã€‚æ•°æ®åº“é‡‡ç”¨å¸¸ç”¨çš„ <code>mysql</code>ã€‚</p>
<blockquote>
<p>æ³¨ï¼š <code>nodejs</code> å¼€å‘å¸¸ç”¨çš„æ•°æ®åº“æ˜¯ <code>mongodb</code>ï¼Œä½†æ˜¯ç”±äº <code>mysql</code> æ¯”è¾ƒå¸¸ç”¨è¿™é‡Œå°±ç”¨ <code>mysql</code> äº†ï¼Œå½“ç„¶å…¶ä»–æ•°æ®åº“ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½ å¯ä»¥æŸ¥æ‰¾ä¸€ä¸‹ <code>nodejs</code> å¦‚ä½•é“¾æ¥è¿™äº›æ•°æ®åº“ï¼Œå¹¶å°†æœ¬æ–‡ä¸­ <code>mysql</code> æ“ä½œçš„éƒ¨åˆ†æ›¿æ¢æ‰å°±å¯ä»¥äº†ã€‚</p>
</blockquote>
<h3 id="æœ¬åœ°æµ‹è¯•å®¢æˆ·ç«¯å®‰è£…">æœ¬åœ°æµ‹è¯•å®¢æˆ·ç«¯å®‰è£…<a hidden class="anchor" aria-hidden="true" href="#æœ¬åœ°æµ‹è¯•å®¢æˆ·ç«¯å®‰è£…">#</a></h3>
<p>ä½ éœ€è¦åœ¨è‡ªå·±ç”¨æ¥å¼€å‘çš„ç”µè„‘ä¸Šå®‰è£…é…ç½®å¦‚ä¸‹ç¯å¢ƒï¼š</p>
<ul>
<li><strong>nodejs</strong></li>
<li><strong>npm</strong></li>
</ul>
<h4 id="å®‰è£…-nodejs">å®‰è£… nodejs<a hidden class="anchor" aria-hidden="true" href="#å®‰è£…-nodejs">#</a></h4>
<p>Linux ä¸‹ç›´æ¥ä½¿ç”¨åŒ…ç®¡ç†å®‰è£…å³å¯ã€‚å¦‚æœåŒ…ç®¡ç†å®‰è£…çš„ node å¾ˆæ—§ï¼Œå¯ä»¥è‡ªè¡Œè°·æ­Œä¸€ä¸‹å®‰è£…æ–¹æ³•ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p>
<p>ä»¥ Ubuntu ä¸ºä¾‹ï¼Œç›´æ¥åœ¨ç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install nodejs
</span></span></code></pre></div><p>å®‰è£…å®Œæˆåä½¿ç”¨ <code>node -v</code> æŸ¥çœ‹ node ç‰ˆæœ¬æ¥ç¡®è®¤å®‰è£…æ˜¯å¦æˆåŠŸã€‚</p>
<p>å¦‚æœæ˜¯ windows ç”¨æˆ·å°±æ›´åŠ ç®€å•äº†ï¼Œç›´æ¥åœ¨ <a href="https://nodejs.org/">nodejs å®˜ç½‘</a> ä¸‹è½½å®‰è£…åŒ…è¿è¡Œå³å¯ã€‚æ¨èä½¿ç”¨é•¿å‘¨æœŸç¨³å®šç‰ˆæœ¬ã€‚å¦‚æœä½ æƒ³ä½“éªŒæ–°ç‰¹æ€§ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨æœ€æ–°çš„ç‰ˆæœ¬ã€‚</p>
<h4 id="å®‰è£…-npm">å®‰è£… npm<a hidden class="anchor" aria-hidden="true" href="#å®‰è£…-npm">#</a></h4>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå®‰è£… <code>nodejs</code> æ—¶ä¼šé™„å¸¦å®‰è£… <code>npm</code>ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>npm -v</code> æ¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿå®‰è£…çš„ <code>npm</code> ç‰ˆæœ¬æ¥æ£€æµ‹å®‰è£…æƒ…å†µã€‚</p>
<p>å¦‚æœæ²¡æœ‰å®‰è£…ï¼Œä»¥ <code>Ubuntu</code> ç³»ç»Ÿä¸ºä¾‹ï¼Œå¯ä»¥åœ¨ç»ˆç«¯æ‰§è¡Œä¸‹é¢çš„æŒ‡ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install npm
</span></span></code></pre></div><p><code>windows</code> ç”¨æˆ·åœ¨æ‰§è¡Œå®Œ <code>node</code> çš„å®‰è£…ç¨‹åºå <code>npm </code> ä¼šè‡ªåŠ¨å®‰è£…å®Œæˆã€‚</p>
<h3 id="æœåŠ¡å™¨å®‰è£…">æœåŠ¡å™¨å®‰è£…<a hidden class="anchor" aria-hidden="true" href="#æœåŠ¡å™¨å®‰è£…">#</a></h3>
<p>ä½ éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…é…ç½®å¦‚ä¸‹ç¯å¢ƒï¼š</p>
<ul>
<li><strong>nodejs</strong></li>
<li><strong>npm</strong></li>
<li><strong>mysql</strong></li>
<li><strong>nginx</strong></li>
</ul>
<h4 id="å®‰è£…-nodejs-ä¸-npm">å®‰è£… nodejs ä¸ npm<a hidden class="anchor" aria-hidden="true" href="#å®‰è£…-nodejs-ä¸-npm">#</a></h4>
<p>å…¶ä¸­ <code>nodejs</code> å’Œ <code>npm</code> çš„å®‰è£…åŒå®¢æˆ·ç«¯å®Œå…¨ç›¸åŒï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p>
<h4 id="å®‰è£…-mysql">å®‰è£… mysql<a hidden class="anchor" aria-hidden="true" href="#å®‰è£…-mysql">#</a></h4>
<p><code>mysql</code> å¯ä»¥ä¸€å¹¶å®‰è£…åœ¨è¿è¡Œ <code>node</code> é¡¹ç›®çš„æœåŠ¡å™¨ä¸Šï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç‹¬ç«‹çš„æ•°æ®åº“æä¾›æœåŠ¡å™¨ã€‚</p>
<p>æœ¬æ–‡ç« ä¸»è¦è®¨è®ºå¦‚ä½•æ„å»º <code>API</code> ï¼Œè¿™é‡Œä¸å†èµ˜è¿°å¦‚ä½•å®‰è£…é…ç½® <code>mysql</code>ã€‚å¯ä»¥æŸ¥çœ‹æˆ‘çš„å…¶ä»–æ–‡ç« ã€‚</p>
<h4 id="å®‰è£…-nginx">å®‰è£… nginx<a hidden class="anchor" aria-hidden="true" href="#å®‰è£…-nginx">#</a></h4>
<p>nginx ç”¨äºå°†æœåŠ¡åå‘ä»£ç†åˆ° 80 ç«¯å£ï¼Œä»¥ <code>Ubuntu</code> ç³»ç»Ÿä¸ºä¾‹ï¼Œç›´æ¥åœ¨ç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install nginx
</span></span></code></pre></div><p>Windows ç”¨æˆ·è‡ªè¡ŒæŸ¥é˜…ç›¸å…³èµ„æ–™ã€‚<!-- raw HTML omitted --><del>ä¸ä¼šå§ï¼Œä¸ä¼šå§ï¼Œä¸ä¼šæœ‰äººæœåŠ¡å™¨ç”¨ windows å§ï¼Ÿï¼Ÿ</del><!-- raw HTML omitted --></p>
<h2 id="é¡¹ç›®æ„å»º">é¡¹ç›®æ„å»º<a hidden class="anchor" aria-hidden="true" href="#é¡¹ç›®æ„å»º">#</a></h2>
<h3 id="ä½¿ç”¨æ¨¡ç‰ˆ">ä½¿ç”¨æ¨¡ç‰ˆ<a hidden class="anchor" aria-hidden="true" href="#ä½¿ç”¨æ¨¡ç‰ˆ">#</a></h3>
<p>ä¸ºäº†æ–¹ä¾¿å¿«é€Ÿæ„å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæˆ‘å†™äº†ä¸€ä¸ªæ¨¡ç‰ˆï¼Œä½ å¯ä»¥åœ¨ <a href="https://github.com/aimerneige/node_json_api_template">GitHub</a> ä¸Šæ‰¾åˆ°å®ƒã€‚</p>
<p>ä½¿ç”¨è¿™ä¸ªæ¨¡ç‰ˆå¿«é€Ÿæ„å»ºä¸€ä¸ªæ–°çš„ä»“åº“ï¼Œå°†å®ƒ clone åˆ°æœ¬åœ°ï¼Œå¹¶è¿›è¡Œä¸‹é¢çš„ä¿®æ”¹ï¼š</p>
<ol>
<li>ä¿®æ”¹ package.json</li>
<li>ä¿®æ”¹ LICENSE</li>
<li>ä¿®æ”¹ README</li>
<li>åœ¨ <code>src/config</code> ä¸‹æ–°å»º <code>db.js</code> å†™å…¥æ•°æ®åº“æœåŠ¡å™¨çš„é…ç½®ã€‚</li>
</ol>
<h3 id="å®‰è£…ä¾èµ–">å®‰è£…ä¾èµ–<a hidden class="anchor" aria-hidden="true" href="#å®‰è£…ä¾èµ–">#</a></h3>
<p>åœ¨é¡¹ç›®è·¯å¾„ä¸‹å¯åŠ¨ç»ˆç«¯ï¼Œæ‰§è¡Œå¦‚ä¸‹æŒ‡ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm i
</span></span></code></pre></div><p>è¿™ä¸ªæŒ‡ä»¤æ˜¯ <code>npm install</code> çš„ç¼©å†™ï¼Œ<code>npm</code> ä¼šå®‰è£…éœ€è¦çš„ä¾èµ–ï¼Œæœ¬æ¨¡ç‰ˆé¡¹ç›®åªä¾èµ–äº†ä¿©ä¸ªåŒ…ï¼š</p>
<ol>
<li>express</li>
<li>mysql</li>
</ol>
<p>ä¾èµ–å®‰è£…å®Œæˆåï¼Œä½ ä¼šåœ¨é¡¹ç›®è·¯å¾„ä¸‹çœ‹åˆ° <code>node_modules</code> è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œå®ƒå·²ç»è¢«å†™åœ¨ <code>.gitignore</code> ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹æ˜¯é¡¹ç›®æ‰€éœ€è¦çš„ä¾èµ–ï¼Œå³ä½¿ä½ æ„å¤–åœ°åˆ æ‰äº†è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œå†æ¬¡æ‰§è¡Œ <code>npm i</code> å°±å¯ä»¥å°†è¿™äº›æ–‡ä»¶ä¸‹è½½å›æ¥ï¼Œæ‰€ä»¥ä½ ä¸åº”è¯¥åœ¨æ„è¿™ä¸ªæ–‡ä»¶å¤¹ä¸­æœ‰ä»€ä¹ˆå†…å®¹ï¼Œ<code>npm</code> ä¼šå¸®æˆ‘ä»¬å¤„ç†å®ƒã€‚</p>
<h3 id="å¯åŠ¨é¡¹ç›®">å¯åŠ¨é¡¹ç›®<a hidden class="anchor" aria-hidden="true" href="#å¯åŠ¨é¡¹ç›®">#</a></h3>
<p>ä½¿ç”¨ <code>cd</code> å‘½ä»¤åˆ‡æ¢åˆ° <code>src</code> ç›®å½•ä¸‹ï¼Œæ‰§è¡Œä¸‹é¢çš„æŒ‡ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>node app.js
</span></span></code></pre></div><p>ä¹‹åä½ ä¼šåœ¨ç»ˆç«¯çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Server start in development mode on http://localhost:4000; press Ctrl + C to terminated.
</span></span></code></pre></div><p>æ‰“å¼€ä½ çš„æµè§ˆå™¨è®¿é—® <a href="http://localhost:4000/">http://localhost:4000/</a></p>
<p>å¦‚æœä½ çœ‹åˆ°ä¸‹é¢çš„å†…å®¹ï¼Œè¯´æ˜é¡¹ç›®æˆåŠŸå¯åŠ¨äº†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{ <span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#ae81ff">200</span>, <span style="color:#f92672">&#34;info&#34;</span>: <span style="color:#e6db74">&#34;If you see this, the server deploy success!&#34;</span> }
</span></span></code></pre></div><p>å¦‚æœä½ åœ¨æœåŠ¡å™¨å¯åŠ¨é¡¹ç›®ï¼Œå‡è®¾ä½ çš„æœåŠ¡å™¨ ip ä¸º <code>43.192.82.215</code> å¹¶ä¸”é…ç½®äº†åŸŸå <code>api.aimerneige.com</code> ï¼Œä½ å¯ä»¥é€šè¿‡åœ¨æµè§ˆå™¨å†…è®¿é—®ä¸‹é¢çš„åœ°å€æµ‹è¯•æœåŠ¡å™¨ï¼š</p>
<ul>
<li><a href="http://43.192.82.215:4000/">http://43.192.82.215:4000/</a></li>
<li><a href="http://api.aimerneige.com:4000/">http://api.aimerneige.com:4000/</a></li>
</ul>
<p>æ³¨æ„ï¼š</p>
<ul>
<li>åœ¨æœ¬åœ°æµ‹è¯•å¯åŠ¨çš„æœåŠ¡å™¨åªèƒ½é€šè¿‡ <strong>æœ¬åœ°/å†…ç½‘</strong> è®¿é—®</li>
<li>åœ¨æœ‰å…¬ç½‘ ip çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²çš„æœåŠ¡å¯ä»¥åœ¨ <strong>ä»»æ„æµè§ˆå™¨å†…</strong> æ‰“å¼€</li>
</ul>
<p>å¦‚æœä½ åœ¨æœåŠ¡å™¨æµ‹è¯•ï¼Œè¯·æ³¨æ„ä»¥è¿™æ ·çš„æ–¹å¼è¿è¡Œä»…èƒ½ç”¨æ¥æµ‹è¯•ï¼Œä¸å¯ä»¥ç”¨ä½œç”Ÿäº§ç¯å¢ƒï¼Œåæ–‡ä¼šä»‹ç»å¦‚ä½•åœ¨æœåŠ¡å™¨éƒ¨ç½²é¡¹ç›®ã€‚</p>
<h3 id="ç¨‹åºå…¥å£">ç¨‹åºå…¥å£<a hidden class="anchor" aria-hidden="true" href="#ç¨‹åºå…¥å£">#</a></h3>
<p>é¡¹ç›®å¯ä»¥å¯åŠ¨åï¼Œè¯´æ˜ç¯å¢ƒé…ç½®æ— è¯¯ï¼Œæ¥ä¸‹æ¥å¯ä»¥å¼€å§‹å†™ä»£ç äº†ã€‚</p>
<p>æˆ‘ä»¬ç®€å•çœ‹ä¸€ä¸‹ç¨‹åºçš„å…¥å£ <code>app.js</code></p>
<p>æœ¬é¡¹ç›®ä¾èµ– express æ„å»ºï¼Œé¦–å…ˆå¯¼å…¥ express çš„æ¨¡å—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// require
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;express&#34;</span>);
</span></span></code></pre></div><p>æ¥ä¸‹æ¥å¯¼å…¥è·¯ç”±ç›®å½•ä¸‹çš„è·¯ç”±æ¨¡å—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// user require
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">indexRouter</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;./routes/index&#34;</span>);
</span></span></code></pre></div><p>åˆ›å»º express å¯¹è±¡ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// express app
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>();
</span></span></code></pre></div><p>è®¾ç½®ç›‘å¬ç«¯å£ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// set port
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">set</span>(<span style="color:#e6db74">&#34;port&#34;</span>, <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">PORT</span> <span style="color:#f92672">||</span> <span style="color:#ae81ff">4000</span>);
</span></span></code></pre></div><p>æ·»åŠ å¯ä»¥æ”¯æŒ json è§£æçš„ä¸­é—´ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// json parse
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">express</span>.<span style="color:#a6e22e">json</span>());
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">express</span>.<span style="color:#a6e22e">urlencoded</span>({ <span style="color:#a6e22e">extended</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">false</span> }));
</span></span></code></pre></div><p>æ·»åŠ è·¯ç”±ä¸­é—´ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// routes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">indexRouter</span>);
</span></span></code></pre></div><p>è·¯ç”±åŒ¹é…å¤±è´¥åè¿”å› 404 é”™è¯¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// catch 404 and forward to error handler
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#34;Not Found&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">status</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">404</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">next</span>(<span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>å¤„ç†é”™è¯¯ä¿¡æ¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// error handler
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;application/json&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">status</span> <span style="color:#f92672">||</span> <span style="color:#ae81ff">500</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">status</span> <span style="color:#f92672">||</span> <span style="color:#ae81ff">500</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">message</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">message</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>æ£€æµ‹å½“å‰æ¨¡å—æ˜¯å¦è¢«ç›´æ¥æ‰§è¡Œï¼Œå¦‚æœæ˜¯åˆ™å¯åŠ¨æœåŠ¡å™¨ï¼Œå¦è€…å¯¼å‡ºæ¨¡å—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// check if run app.js directly
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">require</span>.<span style="color:#a6e22e">main</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">module</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;port&#34;</span>), <span style="color:#66d9ef">function</span> () {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;Server start in &#34;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;env&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34; mode on http://localhost:&#34;</span> <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;port&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;; press Ctrl + C to terminated.&#34;</span>
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">app</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å…¶ä»–çš„ä»£ç å¯ä»¥æš‚æ—¶ä¸å»ç†ä¼šï¼Œæœ€é‡è¦çš„æ˜¯è·¯ç”±è¿™ä¸€éƒ¨åˆ†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// å¯¼å…¥è·¯ç”±æ¨¡å—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">indexRouter</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;./routes/index&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#75715e">// æ·»åŠ è·¯ç”±ä¸­é—´ä»¶
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">indexRouter</span>);
</span></span></code></pre></div><p>åœ¨ç¼–å†™ api æ—¶ï¼Œåªéœ€è¦åœ¨ <code>/src/routes</code> ç›®å½•ä¸‹æ–°å»ºè·¯ç”±æ¨¡å—ï¼Œå¹¶åœ¨ <code>app.js</code> ä¸‹å¼•ç”¨å³å¯ã€‚</p>
<h3 id="æ·»åŠ è·¯ç”±">æ·»åŠ è·¯ç”±<a hidden class="anchor" aria-hidden="true" href="#æ·»åŠ è·¯ç”±">#</a></h3>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹é»˜è®¤çš„è·¯ç”±æ¨¡å— <code>index.js</code> ï¼š</p>
<p>å¯¼å…¥ express æ¨¡å—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;express&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">router</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>.<span style="color:#a6e22e">Router</span>();
</span></span></code></pre></div><p>é…ç½®è·¯ç”±è§„åˆ™ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;application/json&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">200</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">200</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">info</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;If you see this, the server deploy success!&#34;</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>å¯¼å‡ºæ¨¡å—ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">router</span>;
</span></span></code></pre></div><p>å…¶ä¸­é‡ç‚¹å³é…ç½®è·¯ç”±è§„åˆ™è¿™ä¸€éƒ¨åˆ†ã€‚</p>
<p>æˆ‘ç›¸ä¿¡è¿™å‡ è¡Œä»£ç è¿˜æ˜¯å¾ˆæ˜“æ‡‚çš„ï¼Œç›¸å¯¹åœ°ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ä½¿ç”¨ post æ–¹æ³•ï¼Œè®¿é—®è·¯å¾„ä¸º <code>/about</code> éœ€è¦è¿™æ ·å†™ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">post</span>(<span style="color:#e6db74">&#34;/about&#34;</span>, <span style="color:#a6e22e">fuction</span>(){ <span style="color:#75715e">/* function */</span> } );
</span></span></code></pre></div><p>è®¾ç½®å¥½è¯·æ±‚æ–¹æ³•å’Œè¯·æ±‚è·¯å¾„åï¼Œå›è°ƒå‡½æ•°ç”¨æ¥å‘å®¢æˆ·ç«¯è¿”å›æ•°æ®ã€‚</p>
<p>è®¾ç½®è¿”å›æ•°æ®ç±»å‹ï¼Œè¿™é‡Œä½¿ç”¨ <code>json</code> è¿›è¡Œæ•°æ®ä¼ è¾“ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;application/json&#34;</span>);
</span></span></code></pre></div><p>è®¾ç½®è¿”å›çŠ¶æ€ç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">200</span>);
</span></span></code></pre></div><p>è¿”å›æŒ‡å®šæ•°æ®ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>(<span style="color:#a6e22e">return_data</span>);
</span></span></code></pre></div><p>ç”±äºå¼€å‘è¯­è¨€ä¸º js ï¼Œè€Œä¸”æœ¬é¡¹ç›®æ·»åŠ äº†è§£æ json çš„ä¸­é—´ä»¶ï¼Œå¦‚æœæƒ³è¦è¿”å› jsonï¼Œä¸éœ€åƒå…¶ä»–è¯­è¨€é‚£æ ·è¦å°†å¯¹è±¡è§£æä¸º json å­—ç¬¦ä¸²ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡å³å¯ï¼Œå®¢æˆ·ç«¯ä¼šæˆåŠŸæ¥æ”¶åˆ°æ­£ç¡®çš„ json å­—ç¬¦ä¸²ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// æœåŠ¡å™¨è¿”å›çš„å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">200</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">info</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;If you see this, the server deploy success!&#34;</span>,
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#75715e">// å®¢æˆ·ç«¯æ‹¿åˆ°çš„å­—ç¬¦ä¸²
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{ <span style="color:#f92672">&#34;status&#34;</span>: <span style="color:#ae81ff">200</span>, <span style="color:#f92672">&#34;info&#34;</span>: <span style="color:#e6db74">&#34;If you see this, the server deploy success!&#34;</span> }
</span></span></code></pre></div><p>ä¹¦å†™å¥½è·¯ç”±æ¨¡å—ååœ¨ <code>app.js</code> ä¸­å¼•ç”¨å³å¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// å¯¼å…¥æ¨¡å—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">indexRouter</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;./routes/index&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ... ä¸­é—´çš„å…¶ä»–ä»£ç 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// åœ¨ app ä¸­åº”ç”¨è·¯ç”±æ¨¡å—
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">indexRouter</span>);
</span></span></code></pre></div><p>è¦æ³¨æ„æ¨¡å—å¯¼å…¥çš„ä½ç½®ï¼Œä¸èƒ½ä¹±æ”¾ã€‚å’Œæ¨¡ç‰ˆä¿æŒä¸€è‡´å³å¯ã€‚</p>
<h3 id="æ·»åŠ æ›´å¤šçš„è·¯ç”±ä¿¡æ¯">æ·»åŠ æ›´å¤šçš„è·¯ç”±ä¿¡æ¯<a hidden class="anchor" aria-hidden="true" href="#æ·»åŠ æ›´å¤šçš„è·¯ç”±ä¿¡æ¯">#</a></h3>
<p>å°±åƒä¸Šé¢çš„ä¾‹å­ä¸­æ‰€å†™çš„ï¼Œæˆ‘ä»¬å¯ä»¥ç»§ç»­æ·»åŠ æ–°çš„è·¯ç”±æ¨¡å—ï¼Œä¹Ÿå¯ä»¥åœ¨åŒä¸€ä¸ªè·¯ç”±æ¨¡å—ä¸‹æ·»åŠ æ›´å¤šçš„è®¿é—®è·¯å¾„ã€‚</p>
<ul>
<li><code>src/app.js</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">indexRouter</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;./routes/index&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">userRouter</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;./routes/user&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">indexRouter</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#e6db74">&#34;/user&#34;</span>, <span style="color:#a6e22e">userRouter</span>);
</span></span></code></pre></div><ul>
<li><code>src/routes/index.js</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// è®¿é—®è·¯å¾„ /
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">fuction</span>(){ <span style="color:#75715e">/* function */</span> } );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// è®¿é—®è·¯å¾„ /about
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;/about&#34;</span>, <span style="color:#66d9ef">function</span>() { <span style="color:#75715e">/* function */</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ...
</span></span></span></code></pre></div><ul>
<li><code>src/routes/user.js</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#75715e">// ...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// è®¿é—®è·¯å¾„ /user/cat
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;/cat&#34;</span>, <span style="color:#a6e22e">fuction</span>(){ <span style="color:#75715e">/* function */</span> } );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// è®¿é—®è·¯å¾„ /user/edit
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">post</span>(<span style="color:#e6db74">&#34;/edit&#34;</span>, <span style="color:#a6e22e">fuction</span>(){ <span style="color:#75715e">/* function */</span> } );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// è®¿é—®è·¯å¾„ /user/new
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">psot</span>(<span style="color:#e6db74">&#34;/new&#34;</span>, <span style="color:#a6e22e">fuction</span>(){ <span style="color:#75715e">/* function */</span> } );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// ...
</span></span></span></code></pre></div><h3 id="è·å–å®¢æˆ·ç«¯æ•°æ®">è·å–å®¢æˆ·ç«¯æ•°æ®<a hidden class="anchor" aria-hidden="true" href="#è·å–å®¢æˆ·ç«¯æ•°æ®">#</a></h3>
<h4 id="è·å–è¯·æ±‚å‚æ•°ä¿¡æ¯">è·å–è¯·æ±‚å‚æ•°ä¿¡æ¯<a hidden class="anchor" aria-hidden="true" href="#è·å–è¯·æ±‚å‚æ•°ä¿¡æ¯">#</a></h4>
<p><code>req.query</code> å¯¹è±¡æ˜¯ç”±å®¢æˆ·ç«¯è¯·æ±‚å‚æ•°æ„æˆçš„ï¼Œåœ¨å›è°ƒå‡½æ•°å†…ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨å®ƒæ¥è·å–å®¢æˆ·ç«¯è¯·æ±‚å‚æ•°ï¼Œå¦‚æœå®¢æˆ·ç«¯ä¼ é€’äº†å‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°å¯¹åº”çš„æ•°æ®ï¼Œå¦è€…æˆ‘ä»¬åªèƒ½å¾—åˆ° <code>undefined</code>ã€‚ç”±æ­¤å¯ä»¥é€šè¿‡åˆ¤ç©ºæ¥ç¡®å®šå®¢æˆ·ç«¯è¯·æ±‚å‚æ•°æ˜¯å¦æ­£ç¡®ã€‚</p>
<p>ä¾‹å¦‚æˆ‘ä»¬çš„è¯·æ±‚è·¯å¾„ä¸º <code>/data</code> æ‰€éœ€è¯·æ±‚å‚æ•°ä¸º <code>id</code> å’Œ <code>class</code> å¯ä»¥è¿™æ ·å†™ï¼š</p>
<blockquote>
<p>æ³¨ï¼š å¯¹åº”çš„ç¤ºä¾‹è¯·æ±‚åœ°å€ä¸º <code>https://api.example.com/data?id=1930201&amp;class=302</code></p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;/data&#34;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;application/json&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">query</span>.<span style="color:#66d9ef">class</span> <span style="color:#f92672">===</span> <span style="color:#66d9ef">undefined</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">query</span>.<span style="color:#a6e22e">id</span> <span style="color:#f92672">===</span> <span style="color:#66d9ef">undefined</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">400</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å‘å®¢æˆ·ç«¯è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæç¤ºå®¢æˆ·ç«¯è¿”å›æ­£ç¡®çš„å‚æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">400</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">info</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Wrong arguments!&#34;</span>,
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å‘ç”¨æˆ·è¿”å›æ•°æ®ï¼ˆé€šå¸¸ä¼šç”¨å®¢æˆ·ç«¯å‚æ•°æ¥è°ƒç”¨æ•°æ®åº“ï¼Œä¸ºäº†ç®€ä¾¿è¿™é‡Œè¿”å›ä¸€ä¸ªç±»åšç®€å•ç¤ºèŒƒï¼‰
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">200</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">200</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">info</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">class</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">query</span>.<span style="color:#66d9ef">class</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">query</span>.<span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ¤ç©ºæ¥ç¡®å®šå®¢æˆ·ç«¯è¯·æ±‚å‚æ•°æ˜¯å¦æ­£ç¡®ï¼Œä¹‹åå¯ä»¥ä½¿ç”¨å‚æ•°æ¥è¿›è¡Œå…¶ä»–æ“ä½œï¼Œæ¯”å¦‚æ„å»ºç±»ï¼Œè°ƒå–æ•°æ®åº“ç­‰ç­‰ã€‚</p>
<h4 id="è·å–è¯·æ±‚ä½“ä¿¡æ¯">è·å–è¯·æ±‚ä½“ä¿¡æ¯<a hidden class="anchor" aria-hidden="true" href="#è·å–è¯·æ±‚ä½“ä¿¡æ¯">#</a></h4>
<p>ä¸è¯·æ±‚å‚æ•°ç±»ä¼¼ï¼Œè¯·æ±‚ä½“ä¿¡æ¯ä¹Ÿä¿å­˜åœ¨ä¸€ä¸ªç±»ä¸­ï¼Œå°±æ˜¯ <code>req.body</code>ã€‚ä½¿ç”¨æ–¹æ³•å’Œä¹‹å‰è¯·æ±‚å‚æ•°å®Œå…¨ä¸€è‡´ï¼Œè¿™é‡Œåªå†™ä¸€ä¸ªç¤ºä¾‹ï¼Œä¸å¤šèµ˜è¿°ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">router</span>.<span style="color:#a6e22e">post</span>(<span style="color:#e6db74">&#34;/new&#34;</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">type</span>(<span style="color:#e6db74">&#34;application/json&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#66d9ef">class</span> <span style="color:#f92672">===</span> <span style="color:#66d9ef">undefined</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">id</span> <span style="color:#f92672">===</span> <span style="color:#66d9ef">undefined</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">400</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å‘å®¢æˆ·ç«¯è¿”å›é”™è¯¯ä¿¡æ¯ï¼Œæç¤ºå®¢æˆ·ç«¯è¿”å›æ­£ç¡®çš„å‚æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">400</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">info</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Wrong arguments!&#34;</span>,
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">new_student</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">class</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#66d9ef">class</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">id</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">body</span>.<span style="color:#a6e22e">id</span>,
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å‘æ•°æ®åº“å†…æ·»åŠ æ–°çš„å­¦ç”Ÿ
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">200</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>({
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">200</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">info</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Student create successful!&#34;</span>,
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><h4 id="è·å–æ›´å¤šä¿¡æ¯">è·å–æ›´å¤šä¿¡æ¯<a hidden class="anchor" aria-hidden="true" href="#è·å–æ›´å¤šä¿¡æ¯">#</a></h4>
<p>åœ¨å›è°ƒå‡½æ•°ä¸­ï¼Œreq å¯¹è±¡ä¸­ä¿å­˜äº†æ‰€æœ‰æ¥è‡ªå®¢æˆ·è¯·æ±‚çš„æ•°æ®ï¼Œå‰é¢ä»‹ç»çš„åªæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„ï¼Œå…¶ä»–å†…å®¹å¯ä»¥æŸ¥æ‰¾æ–‡æ¡£ã€‚</p>
<h3 id="è·å–æ•°æ®åº“ä¿¡æ¯">è·å–æ•°æ®åº“ä¿¡æ¯<a hidden class="anchor" aria-hidden="true" href="#è·å–æ•°æ®åº“ä¿¡æ¯">#</a></h3>
<h4 id="é…ç½®æ•°æ®åº“ä¿¡æ¯">é…ç½®æ•°æ®åº“ä¿¡æ¯<a hidden class="anchor" aria-hidden="true" href="#é…ç½®æ•°æ®åº“ä¿¡æ¯">#</a></h4>
<p>å‚è€ƒ <code>db.js.example</code> åˆ›å»º <code>db.js</code> å†™å…¥æœåŠ¡å™¨çš„é…ç½®</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">mysql</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;mysql&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">pool</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">mysql</span>.<span style="color:#a6e22e">createPool</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">host</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;host_ip&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">user</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;user_name&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">password</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;password&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">database</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;data&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">port</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3306</span>,
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">query</span>(<span style="color:#a6e22e">sql</span>, <span style="color:#a6e22e">callback</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pool</span>.<span style="color:#a6e22e">getConnection</span>(<span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">connection</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">connection</span>.<span style="color:#a6e22e">query</span>(<span style="color:#a6e22e">sql</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">rows</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">callback</span>(<span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">rows</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">connection</span>.<span style="color:#a6e22e">release</span>();
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">exports</span>.<span style="color:#a6e22e">query</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">query</span>;
</span></span></code></pre></div><p>é…ç½®å¥½æ•°æ®åº“æœåŠ¡å™¨åï¼Œå°±å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•è®¿é—®æ•°æ®åº“çš„æ•°æ®äº†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">sql_command</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;DROP DATABASE *;&#34;</span>; <span style="color:#75715e">// âš ï¸ æ³¨æ„ä¿®æ”¹
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">query</span>(<span style="color:#a6e22e">sql_command</span>, <span style="color:#66d9ef">function</span> (<span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">result</span>, <span style="color:#a6e22e">fields</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">err</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å¦‚æœæ•°æ®åº“æŒ‡ä»¤æ‰§è¡Œå‡ºç°äº†é”™è¯¯ï¼Œè¿”å›é”™è¯¯ä¿¡æ¯
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">requestSQLFailedLog</span>(<span style="color:#a6e22e">sql_command</span>, <span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">400</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">400</span>, <span style="color:#a6e22e">info</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">err</span> });
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// å¦‚æœæ•°æ®åº“æŒ‡ä»¤æ‰§è¡ŒæˆåŠŸï¼Œè¿”å›æ•°æ®
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">requestSQLSuccessLog</span>(<span style="color:#a6e22e">sql_command</span>, <span style="color:#a6e22e">result</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">200</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>(<span style="color:#a6e22e">result</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><h2 id="æœåŠ¡éƒ¨ç½²">æœåŠ¡éƒ¨ç½²<a hidden class="anchor" aria-hidden="true" href="#æœåŠ¡éƒ¨ç½²">#</a></h2>
<blockquote>
<p>å¾…å®Œå–„ï¼Œå’•å’•å’•</p>
</blockquote>
<ol>
<li>å°†é¡¹ç›®ä¸Šä¼ åˆ°æœåŠ¡å™¨</li>
<li>ä¿®æ”¹ <code>db.js</code> çš„é…ç½®</li>
<li><code>cd src</code></li>
<li><code>node cluster.js</code></li>
<li>å¦‚æœä½ æƒ³è¦åå°è¿è¡Œï¼Œæ‰§è¡Œ <code>nohup node cluster.js &amp;</code></li>
</ol>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://aimerneige.com/zh/tags/nodejs/">nodejs</a></li>
      <li><a href="https://aimerneige.com/zh/tags/javascript/">javascript</a></li>
      <li><a href="https://aimerneige.com/zh/tags/api/">api</a></li>
      <li><a href="https://aimerneige.com/zh/tags/mysql/">mysql</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://aimerneige.com/zh/post/others/hello-hugo/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>Hello Hugo</span>
  </a>
  <a class="next" href="https://aimerneige.com/zh/post/tool/editorconfig/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>åˆ©ç”¨ EditorConfig å®šä¹‰ä»£ç æ ¼å¼ï¼Œç»Ÿä¸€ä»£ç é£æ ¼</span>
  </a>
</nav>

  </footer>
<div id="license">
    <p>
        This article is licensed under
        <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/" style="color: #00b5da">
            <u>CC-BY-NC-4.0</u>
        </a>
    </p>
</div>

<div id="comment">
    <script
        id="utterances"
        src="https://utteranc.es/client.js"
        repo="aimerneige/aimerneige.github.io"
        issue-term="title"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async
    ></script>
    <script>
        
        let ua = navigator.userAgent.toLocaleLowerCase();
        if (ua.match(/QQ/i) == "qq") {
            document.getElementById("utterances").remove();
        }
        if (ua.match(/MicroMessenger/i) == "micromessenger") {
            document.getElementById("utterances").remove();
        }
    </script>
</div>




</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://aimerneige.com/zh/">Aimer&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerHTML = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerHTML = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
